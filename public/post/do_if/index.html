<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.69.2" />
  <meta name="author" content="Fabio Votta">
  <meta name="description" content="Empirical Social and Political Research">

  
  <link rel="alternate" hreflang="en-us" href="/post/do_if/">

  
  


  

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-121993278-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/do_if/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@https://twitter.com/favstats">
  <meta property="twitter:creator" content="@https://twitter.com/favstats">
  
  <meta property="og:site_name" content="favstats - personal blog">
  <meta property="og:url" content="/post/do_if/">
  <meta property="og:title" content="do_if | favstats - personal blog">
  <meta property="og:description" content=""><meta property="og:image" content="/img/headers/do_if.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-05-14T00:00:00&#43;02:00">
  
  <meta property="article:modified_time" content="2019-05-14T00:00:00&#43;02:00">
  

  

  <title>do_if | favstats - personal blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/logo.png" alt="favstats - personal blog"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#awards">
            
            <span>Awards</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/do_if.png" class="article-banner" itemprop="image">
  <span class="article-header-caption">Pipable if statement</span>
</div>



  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">do_if</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2019-05-14 00:00:00 &#43;0200 CEST" itemprop="datePublished">
      May 14, 2019
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/do_if/#disqus_thread"></a>
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=do_if&amp;url=%2fpost%2fdo_if%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fdo_if%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fdo_if%2f&amp;title=do_if"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fdo_if%2f&amp;title=do_if"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=do_if&amp;body=%2fpost%2fdo_if%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <p>So recently I was writing functions with many if statements and pipes. Given that
I am a huge fan of the <code>%&gt;%</code> pipe workflow, I was thinking about
creating a pipable if environment. Here is my attempt to implement
exactly that. With a lot help from my good friend <a href="https://twitter.com/Ben_Guinaudeau">Ben</a>. If you are reading this, thank you! You made this possible.</p>
<p>Import gist from here:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(dplyr)
<span style="color:#a6e22e">source</span>(<span style="color:#e6db74">&#34;https://gist.githubusercontent.com/favstats/3e1d8b65a019b24344b7b3dea6002a0b/raw/6919b22f01db6d672d64ebcac5798b8495c89ad2/do_if.R&#34;</span>)
</code></pre></div><p>So let’s say you want to create a function that has multiple if
specifications but you also want to always create two columns regardless
of the input. You might create something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mock_function <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(.data, argument <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>) {
  
  <span style="color:#a6e22e">if </span>(argument <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;do_this1&#34;</span>) {
    .data <span style="color:#f92672">&lt;-</span>.data <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(am <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">mutate</span>(x <span style="color:#f92672">=</span> disp <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">100</span>)
  } else <span style="color:#a6e22e">if </span>(argument <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;do_this2&#34;</span>) {
    .data <span style="color:#f92672">&lt;-</span>.data <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(am <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">mutate</span>(x <span style="color:#f92672">=</span> disp <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100</span>)
  }
  
  final <span style="color:#f92672">&lt;-</span> .data <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(new_column <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Say What&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(other_column <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Say That&#34;</span>)
  
  <span style="color:#a6e22e">return</span>(final)
  
}
</code></pre></div><p>So if you leave the argument blank you will receive the entire dataset
with two new columns:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(vs<span style="color:#f92672">:</span>other_column) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 32 x 6
##       vs    am  gear  carb new_column other_column
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       
##  1     0     1     4     4 Say What   Say That    
##  2     0     1     4     4 Say What   Say That    
##  3     1     1     4     1 Say What   Say That    
##  4     1     0     3     1 Say What   Say That    
##  5     0     0     3     2 Say What   Say That    
##  6     1     0     3     1 Say What   Say That    
##  7     0     0     3     4 Say What   Say That    
##  8     1     0     4     2 Say What   Say That    
##  9     1     0     4     2 Say What   Say That    
## 10     1     0     4     4 Say What   Say That    
## # ... with 22 more rows
</code></pre>
<p>If you add <code>&quot;do_this1</code> to the argument you will receive a filtered
dataset:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>(<span style="color:#e6db74">&#34;do_this1&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(vs<span style="color:#f92672">:</span>other_column) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 3 x 7
##      vs    am  gear  carb x     new_column other_column
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;      &lt;chr&gt;       
## 1     0     1     4     4 TRUE  Say What   Say That    
## 2     0     1     4     4 TRUE  Say What   Say That    
## 3     0     1     5     6 TRUE  Say What   Say That
</code></pre>
<p>And if you specify <code>&quot;do_this2</code> it will create a different subset.. but
always with the <code>new_column</code> and <code>other_column</code> intact.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>(<span style="color:#e6db74">&#34;do_this2&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(vs<span style="color:#f92672">:</span>other_column) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 3 x 7
##      vs    am  gear  carb x     new_column other_column
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;      &lt;chr&gt;       
## 1     1     0     4     2 FALSE Say What   Say That    
## 2     1     0     4     2 FALSE Say What   Say That    
## 3     1     0     3     1 FALSE Say What   Say That
</code></pre>
<p>Now this would work just fine. But what if you have multiple if
statements along your pipe chain and you don’t want to split into so
many different if statements? Well this is where <code>do_if</code> comes in!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e">#&#39; A pipable if statement</span>
<span style="color:#75715e">#&#39;</span>
<span style="color:#75715e">#&#39; This function allows to create an if statement that can be used within a pipable workflow</span>
<span style="color:#75715e">#&#39;</span>
<span style="color:#75715e">#&#39; @importFrom magrittr %&gt;%</span>
<span style="color:#75715e">#&#39; @importFrom rlang parse_expr</span>
<span style="color:#75715e">#&#39; @param .data tibble</span>
<span style="color:#75715e">#&#39; @param condition logical test</span>
<span style="color:#75715e">#&#39; @param call a formula descibing a pipe to be evaluated if condition is \code{code}</span>
<span style="color:#75715e">#&#39; @examples</span>
<span style="color:#75715e">#&#39; any_condition &lt;- T</span>
<span style="color:#75715e">#&#39;</span>
<span style="color:#75715e">#&#39; mtcars %&gt;%</span>
<span style="color:#75715e">#&#39; do_if(any_condition, ~{</span>
<span style="color:#75715e">#&#39; .x %&gt;%</span>
<span style="color:#75715e">#&#39;  dplyr::filter(cyl == 6) %&gt;%</span>
<span style="color:#75715e">#&#39;  dplyr::mutate(x = disp &gt; 170)</span>
<span style="color:#75715e">#&#39; })</span>
<span style="color:#75715e">#&#39; @export</span>
do_if <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(.data, condition, call){

  <span style="color:#a6e22e">if</span>(condition){
    .x <span style="color:#f92672">&lt;-</span> .data

    call_str <span style="color:#f92672">&lt;-</span> call <span style="color:#f92672">%&gt;%</span>
      as.character <span style="color:#f92672">%&gt;%</span>
      .[2]

    out <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">eval</span>(rlang<span style="color:#f92672">::</span><span style="color:#a6e22e">parse_expr</span>(call_str))

    <span style="color:#a6e22e">return</span>(out)
  } else {
    <span style="color:#a6e22e">return</span>(.data)
  }
}
</code></pre></div><p>With <code>do_if</code> you can specify an if statement <em>within</em> a pipable
workflow!</p>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">any_condition <span style="color:#f92672">&lt;-</span> T

mtcars <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">do_if</span>(any_condition, <span style="color:#f92672">~</span>{
    .x <span style="color:#f92672">%&gt;%</span>
      dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">%&gt;%</span>
      dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">mutate</span>(x <span style="color:#f92672">=</span> disp <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">170</span>)
    }) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 7 x 12
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb x    
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;
## 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4 FALSE
## 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4 FALSE
## 3  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1 TRUE 
## 4  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1 TRUE 
## 5  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4 FALSE
## 6  17.8     6  168.   123  3.92  3.44  18.9     1     0     4     4 FALSE
## 7  19.7     6  145    175  3.62  2.77  15.5     0     1     5     6 FALSE
</code></pre>
<p>This can come in really handy if you are not a big fan of seperating
your pipe workflow all too often. Let’s recreate the mock_function with
the help of <code>do_if</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mock_function <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(.data, argument <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>) {
  .data <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">do_if</span>(
      argument <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;do_this1&#34;</span>,
      <span style="color:#f92672">~</span>{.x <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(am <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">mutate</span>(x <span style="color:#f92672">=</span> disp <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">100</span>)
        }
    ) <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">do_if</span>(
      argument <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;do_this2&#34;</span>,
      <span style="color:#f92672">~</span>{.x <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(am <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">filter</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">%&gt;%</span>
          dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">mutate</span>(x <span style="color:#f92672">=</span> disp <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">100</span>)
        }
    ) <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(other_column <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Say That&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(new_column <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Say What&#34;</span>) 
}
</code></pre></div><p>And again we can get the same results, only with a slighly less
troublesome workflow within a function!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 32 x 13
##      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
##  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
##  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
##  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
##  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
##  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
##  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
##  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
##  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
## 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
## # ... with 22 more rows, and 2 more variables: other_column &lt;chr&gt;,
## #   new_column &lt;chr&gt;
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>(argument <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;do_this1&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 3 x 14
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb x    
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;
## 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4 TRUE 
## 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4 TRUE 
## 3  19.7     6   145   175  3.62  2.77  15.5     0     1     5     6 TRUE 
## # ... with 2 more variables: other_column &lt;chr&gt;, new_column &lt;chr&gt;
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mtcars <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mock_function</span>(argument <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;do_this2&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as_tibble</span>()
</code></pre></div><pre><code>## # A tibble: 3 x 14
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb x    
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;
## 1  24.4     4  147.    62  3.69  3.19  20       1     0     4     2 FALSE
## 2  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2 FALSE
## 3  21.5     4  120.    97  3.7   2.46  20.0     1     0     3     1 FALSE
## # ... with 2 more variables: other_column &lt;chr&gt;, new_column &lt;chr&gt;
</code></pre>
<p>UPDATE:</p>
<p><a href="https://twitter.com/kearneymw">Mike Kearney</a> created a much smoother version with the ability to create an else statement as well.</p>
<p>Check it out <a href="https://gist.github.com/mkearney/bb2ce47eb635c14d5f99151636e26b21">here</a>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">
<span style="color:#75715e">#&#39; Conditionally apply expressions on a data object</span>
<span style="color:#75715e">#&#39; </span>
<span style="color:#75715e">#&#39; @param .data Input data</span>
<span style="color:#75715e">#&#39; @param condition A logical value to determine whether to use .if or .else</span>
<span style="color:#75715e">#&#39; @param .if Formula or function to apply to intput data when condition is TRUE</span>
<span style="color:#75715e">#&#39; @param .else Formula or function to apply to intput data when condition is FALSE</span>
<span style="color:#75715e">#&#39; @return Output of appropriate .if/.else call</span>
<span style="color:#75715e">#&#39; @export</span>
<span style="color:#75715e">#&#39; @importFrom rlang as_closure</span>
do_if_else <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(.data, condition, .if, .else <span style="color:#f92672">=</span> identity) {
  <span style="color:#a6e22e">if </span>(condition) {
    call <span style="color:#f92672">&lt;-</span> rlang<span style="color:#f92672">::</span><span style="color:#a6e22e">as_closure</span>(.if)
  } else {
    call <span style="color:#f92672">&lt;-</span> rlang<span style="color:#f92672">::</span><span style="color:#a6e22e">as_closure</span>(.else)
  }
  <span style="color:#a6e22e">do.call</span>(call, <span style="color:#a6e22e">list</span>(.data))
}
</code></pre></div><p>Usage Example:</p>
<p><img src="https://pbs.twimg.com/media/D6i5BJ2X4AAcnVx.jpg" alt=""></p>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/functions">functions</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/rstats">rstats</a>
  
</div>



    </div>
  </div>

</article>






<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-favstats-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      © 2019 Fabio Votta &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//https-favstats-netlify-com.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

