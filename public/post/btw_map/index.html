<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.37.1" />
  <meta name="author" content="Fabio Votta">
  <meta name="description" content="Empirical Social and Political Research">

  
  <link rel="alternate" hreflang="en-us" href="/post/btw_map/">

  
  


  

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-121993278-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/btw_map/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@https://twitter.com/favstats">
  <meta property="twitter:creator" content="@https://twitter.com/favstats">
  
  <meta property="og:site_name" content="favstats - personal blog">
  <meta property="og:url" content="/post/btw_map/">
  <meta property="og:title" content="Visualizing Results of German Elections (2013 and 2017) | favstats - personal blog">
  <meta property="og:description" content=""><meta property="og:image" content="/img/headers/election_map.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-09-19T00:00:00&#43;02:00">
  
  <meta property="article:modified_time" content="2018-09-19T00:00:00&#43;02:00">
  

  

  <title>Visualizing Results of German Elections (2013 and 2017) | favstats - personal blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/logo.png" alt="favstats - personal blog"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#awards">
            
            <span>Awards</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/election_map.png" class="article-banner" itemprop="image">
  <span class="article-header-caption">AfD Results of the 2013 and 2017 German Elections</span>
</div>



  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Visualizing Results of German Elections (2013 and 2017)</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-09-19 00:00:00 &#43;0200 CEST" itemprop="datePublished">
      Sep 19, 2018
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    23 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/btw_map/#disqus_thread"></a>
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29&amp;url=%2fpost%2fbtw_map%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fbtw_map%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fbtw_map%2f&amp;title=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fbtw_map%2f&amp;title=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29&amp;body=%2fpost%2fbtw_map%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        

<p>Data
Sources:</p>

<p><a href="https://www.govdata.de/web/guest/apps/-/details/bundestagswahl-2017" target="_blank">https://www.govdata.de/web/guest/apps/-/details/bundestagswahl-2017</a></p>

<p><a href="https://www.bundeswahlleiter.de/bundestagswahlen/2017/strukturdaten.html" target="_blank">https://www.bundeswahlleiter.de/bundestagswahlen/2017/strukturdaten.html</a></p>

<h2 id="settings-packages-and-folders">Settings, Packages and Folders</h2>

<pre><code class="language-r">options(scipen = 999)
knitr::opts_chunk$set(message = F,  warning = F, error = F, 
                      fig.align = &quot;center&quot;, 
                      fig.width = 10, fig.height = 6)
# Install these packages if you don't have theme yet
# devtools::install_github(&quot;favstats/tidytemplate&quot;)
# install.packages(&quot;pacman&quot;)

pacman::p_load(tidyverse)

# Creates folders
# tidytemplate::data_dir()
# tidytemplate::images_dir()
</code></pre>

<h2 id="helper-functions">Helper Functions</h2>

<pre><code class="language-r">get_percentage &lt;- function(part, total, digits = NULL) {

  if(!is.numeric(part) | !is.numeric(total)){
    cat(&quot;Non-numeric variables.. converting\n&quot;)
    part &lt;- as.numeric(part)
    total &lt;- as.numeric(total)
  }
   val &lt;- part / total * 100
   if(!is.null(digits)){
   val &lt;- round(val, digits)
   }
  return(val) 
}


get_labs &lt;- function (pval) 
{
  dplyr::case_when(is.na(pval) ~ &quot;&quot;, 
                   pval &lt; 0.001 ~ &quot;p &lt; 0.001&quot;,
                   pval &lt; 0.01 ~ &quot;p &lt; 0.01&quot;, 
                   pval &lt; 0.05 ~ &quot;p &lt; 0.05&quot;, 
                   pval &lt; 0.1 ~  &quot;p &lt; 0.10&quot;, 
      TRUE ~ &quot;p &gt; 0.10&quot;)
}


get_r2_label &lt;- function(mod, digits = 3, adj = F){
  if(!adj){#
    message(&quot;R Squared\n&quot;)
r2 &lt;- broom::glance(mod) %&gt;%
    mutate(r.squared = r.squared * 100) %&gt;% 
    .$r.squared %&gt;% 
    format(., digits = digits) %&gt;% 
    paste0(., &quot;%&quot;)
return(r2)
  } else {
    message(&quot;Getting Adjusted R Squared\n&quot;)
    r2 &lt;- broom::glance(mod) %&gt;%
      mutate(adj.r.squared = adj.r.squared * 100) %&gt;% 
      .$adj.r.squared %&gt;% 
      format(., digits = digits) %&gt;% 
      paste0(., &quot;%&quot;)    
return(r2)
  }
}
</code></pre>

<h2 id="load-data">Load Data</h2>

<h3 id="btw13">BTW13</h3>

<pre><code class="language-r">## loading in district names
district_names &lt;- tidytemplate::load_it(&quot;data/district_names.Rdata&quot;)


vars13 &lt;- c(&quot;wahlkreis_nr&quot;, &quot;kreis&quot;, &quot;part_of&quot;, &quot;valid&quot;, &quot;CDU&quot;, &quot;SPD&quot;, &quot;FDP&quot;, &quot;DIE LINKE&quot;, &quot;GRÜNE&quot;, &quot;CSU&quot;, &quot;PIRATEN&quot;, &quot;NPD&quot;, &quot;Tierschutzpartei&quot;, &quot;REP&quot;, &quot;ÖDP&quot;, &quot;FAMILIE&quot;, &quot;Bündnis 21/RRP&quot;, &quot;RENTNER&quot;, &quot;BP&quot;, &quot;PBC&quot;, &quot;BüSo&quot;, &quot;DIE VIOLETTEN&quot;, &quot;MLPD&quot;, &quot;Volksabstimmung&quot;, &quot;PSG&quot;, &quot;AfD&quot;, &quot;BIG&quot;, &quot;pro Deutschland&quot;, &quot;DIE RECHTE&quot;, &quot;DIE FRAUEN&quot;, &quot;FREIE WÄHLER&quot;, &quot;Nichtwähler&quot;, &quot;PARTEI DER VERNUNFT&quot;, &quot;Die PARTEI&quot;, &quot;B&quot;, &quot;BGD&quot;, &quot;DKP&quot;, &quot;NEIN!&quot;, &quot;Übrige&quot;)

 # ss %&gt;% 

btw13 &lt;- readr::read_delim(&quot;data/btw13_kerg.csv&quot;, 
                           &quot;;&quot;, escape_double = FALSE, 
                           comment = &quot;#&quot;, 
                           trim_ws = TRUE)  %&gt;% 
  janitor::clean_names() %&gt;% 
  select(nr, gebiet, geh_f6_rt, str_which(pattern = &quot;Endg&lt;fc&gt;ltig&quot;, .)) %&gt;%
  select(nr, gebiet, geh_f6_rt, str_which(pattern = &quot;Zweitstimme&quot;, .))  %&gt;% 
  select(-x6, -x10, -x14) %&gt;% 
  set_names(vars13) %&gt;% 
  mutate(cdu_csu = ifelse(is.na(CDU), CSU, CDU)) %&gt;% 
  mutate(perc_cdu_csu = get_percentage(cdu_csu, valid)) %&gt;%
  mutate(perc_spd = get_percentage(SPD, valid)) %&gt;%
  mutate(perc_linke = get_percentage(`DIE LINKE`, valid)) %&gt;%
  mutate(perc_fdp = get_percentage(FDP, valid)) %&gt;%
  mutate(perc_grun = get_percentage(`GRÜNE`, valid)) %&gt;%
  mutate(perc_afd = get_percentage(AfD, valid)) %&gt;%
  mutate(NPD = ifelse(is.na(NPD), &quot;0&quot;, NPD)) %&gt;% 
  mutate(perc_npd = get_percentage(NPD, valid)) %&gt;%
  select(wahlkreis_nr, kreis, part_of, valid, perc_afd, 
         perc_npd, perc_spd, perc_linke, perc_fdp, 
         perc_grun, perc_cdu_csu) %&gt;% 
  drop_na(wahlkreis_nr) %&gt;% 
  filter(part_of != 99)
</code></pre>

<pre><code>## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
</code></pre>

<pre><code class="language-r">strukturdaten13 &lt;- read_delim(&quot;data/btw13_strukturdaten.csv&quot;, 
                              &quot;;&quot;, escape_double = FALSE,
                              comment = &quot;#&quot;, 
                              trim_ws = TRUE, 
                              col_types = cols(.default = &quot;c&quot;)) %&gt;% 
  janitor::clean_names() %&gt;% 
  .[-1,] %&gt;% 
  mutate(unemployment = str_replace(arbeitslosenquote_ende_dezember_2012_insgesamt, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;% 
  mutate(sgbii = str_replace(empf_e4_nger_innen_von_leistungen_nach_sgb_ii_am_31_12_2012_insgesamt_je_1000_einwohner, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;%   
  mutate(wanderung = str_replace(zu_bzw_abnahme_der_bev_f6_lkerung_2011_wanderungssaldo_je_1000_einwohner, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;%  
  filter(!(str_detect(wahlkreis_name, &quot;insgesamt|Insgesamt&quot;))) %&gt;% 
  select(wahlkreis_nr, wanderung, unemployment, sgbii, wahlkreis_name, land) %&gt;%
  mutate(wahlkreis_nr = as.integer(wahlkreis_nr))

btw13_data &lt;- btw13 %&gt;% 
  left_join(strukturdaten13) %&gt;% 
  select(-kreis, -wahlkreis_name) %&gt;% 
  left_join(district_names)

tidytemplate::save_it(btw13_data)

btw13_data
</code></pre>

<pre><code>## # A tibble: 299 x 15
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 1       1606~     4.09    0.578     32.6       5.66
##  2            2 1       1300~     3.84    0.564     29.7       4.41
##  3            3 1       1249~     4.40    0.831     30.0       5.03
##  4            4 1       1479~     4.39    0.577     31.5       4.36
##  5            5 1       1449~     3.71    0.553     34.7       6.91
##  6            6 1       1255~     4.70    0.923     32.7       4.77
##  7            7 1       1773~     4.78    0.744     31.2       5.02
##  8            8 1       1815~     4.97    0.720     30.1       5.02
##  9            9 1       1304~     4.96    0.565     31.5       4.34
## 10           10 1       1814~     5.63    0.759     29.7       4.94
## # ... with 289 more rows, and 8 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, wanderung &lt;dbl&gt;,
## #   unemployment &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;
</code></pre>

<h3 id="btw-17">BTW 17</h3>

<pre><code class="language-r">vars17 &lt;- c(&quot;wahlkreis_nr&quot;, &quot;kreis&quot;, &quot;part_of&quot;, &quot;valid&quot;, &quot;Christlich Demokratische Union Deutschlands&quot;, &quot;Sozialdemokratische Partei Deutschlands&quot;, &quot;DIE LINKE&quot;, &quot;BÜNDNIS 90/DIE GRÜNEN&quot;, &quot;Christlich-Soziale Union in Bayern e.V.&quot;, &quot;Freie Demokratische Partei&quot;, &quot;Alternative für Deutschland&quot;, &quot;Piratenpartei Deutschland&quot;, &quot;Nationaldemokratische Partei Deutschlands&quot;, &quot;FREIE WÄHLER&quot;, &quot;PARTEI MENSCH UMWELT TIERSCHUTZ&quot;, &quot;Ökologisch-Demokratische Partei&quot;, &quot;Die PARTEI&quot;, &quot;Bayernpartei&quot;, &quot;Ab jetzt...Demokratie durch Volksabstimmung&quot;, &quot;Partei der Vernunft&quot;, &quot;Marxistisch-Leninistische Partei Deutschlands&quot;, &quot;Bürgerrechtsbewegung Solidarität&quot;, &quot;Sozialistische Gleichheitspartei&quot;, &quot;DIE RECHTE&quot;, &quot;Allianz Deutscher Demokraten&quot;, &quot;Allianz für Menschenrechte&quot;, &quot;bergpartei&quot;, &quot;Bündnis Grundeinkommen&quot;, &quot;DEMOKRATIE IN BEWEGUNG&quot;, &quot;Deutsche Kommunistische Partei&quot;, &quot;Deutsche Mitte&quot;, &quot;Die Grauen – Für alle Generationen&quot;, &quot;Die Urbane. Eine HipHop Partei&quot;, &quot;Madgeburger Gartenpartei&quot;, &quot;Menschliche Welt&quot;, &quot;Partei der Humanisten&quot;, &quot;Partei für Gesundheitsforschung&quot;, &quot;V-Partei³ - Partei für Veränderung&quot;, &quot;Bündnis C - Christen für Deutschland&quot;, &quot;DIE EINHEIT&quot;, &quot;Die Violetten&quot;, &quot;Familien-Partei Deutschlands&quot;, &quot;Feministische Partei DIE FRAUEN&quot;, &quot;Mieterpartei&quot;, &quot;Neue Liberale – Die Sozialliberalen&quot;, &quot;UNABHÄNGIGE für bürgernahe Demokratie&quot;, &quot;Übrige&quot;)

btw17 &lt;- readr::read_delim(&quot;data/btw17_kerg.csv&quot;, 
                           &quot;;&quot;, escape_double = FALSE, comment = &quot;#&quot;, 
                           trim_ws = TRUE)  %&gt;% 
  janitor::clean_names() %&gt;% 
  select(nr, gebiet, gehort_zu, grep(&quot;Endgültig&quot;, .)) %&gt;%
  select(nr, gebiet, gehort_zu, grep(&quot;Zweitstimme&quot;, .)) %&gt;% 
  select(-x6, -x10, -x14) %&gt;% 
  set_names(vars17) %&gt;% 
  mutate(cdu_csu = ifelse(is.na(`Christlich Demokratische Union Deutschlands`), 
                          `Christlich-Soziale Union in Bayern e.V.`, 
                          `Christlich Demokratische Union Deutschlands`)) %&gt;% 
  mutate(perc_cdu_csu = get_percentage(cdu_csu, valid)) %&gt;%
  mutate(perc_spd = get_percentage(`Sozialdemokratische Partei Deutschlands`, valid)) %&gt;%
  mutate(perc_linke = get_percentage(`DIE LINKE`, valid)) %&gt;%
  mutate(perc_fdp = get_percentage(`Freie Demokratische Partei`, valid)) %&gt;%
  mutate(perc_grun = get_percentage(`BÜNDNIS 90/DIE GRÜNEN`, valid)) %&gt;%
  mutate(perc_afd = get_percentage(`Alternative für Deutschland`, valid)) %&gt;%
  mutate(NPD = ifelse(is.na(`Nationaldemokratische Partei Deutschlands`), 
                      &quot;0&quot;, 
                      `Nationaldemokratische Partei Deutschlands`)) %&gt;% 
  mutate(perc_npd = get_percentage(NPD, valid)) %&gt;%
  select(wahlkreis_nr, kreis, part_of, valid, perc_afd, 
         perc_npd, perc_spd, perc_linke, perc_fdp, 
         perc_grun, perc_cdu_csu) %&gt;% 
  drop_na(wahlkreis_nr) %&gt;% 
  filter(part_of != 99)
</code></pre>

<pre><code>## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
</code></pre>

<pre><code class="language-r">btw17
</code></pre>

<pre><code>## # A tibble: 299 x 11
##    wahlkreis_nr kreis part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 Flen~       1 1704~     6.84    0.205     23.7       8.21
##  2            2 Nord~       1 1380~     6.54    0.218     22.5       6.22
##  3            3 Stei~       1 1308~     8.54    0.360     22.7       6.67
##  4            4 Rend~       1 1562~     7.41    0.196     22.9       6.37
##  5            5 Kiel        1 1520~     6.91    0.164     23.8      10.2 
##  6            6 Plön~       1 1305~     8.55    0.367     23.8       6.52
##  7            7 Pinn~       1 1863~     8.57    0.239     22.9       7.03
##  8            8 Sege~       1 1919~     8.94    0.241     22.4       6.90
##  9            9 Osth~       1 1372~     8.58    0.219     24.6       6.05
## 10           10 Herz~       1 1919~     9.79    0.256     22.3       6.50
## # ... with 289 more rows, and 3 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;
</code></pre>

<pre><code class="language-r">strukturdaten17 &lt;- read_delim(&quot;data/btw17_strukturdaten.csv&quot;, 
                              &quot;;&quot;, escape_double = FALSE,
                              col_types = cols(.default = &quot;c&quot;), 
                              comment = &quot;#&quot;, 
                              trim_ws = TRUE, 
                              skip = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(unemployment = str_replace(arbeitslosenquote_marz_2017_insgesamt, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;% 
  mutate(wanderung = str_replace(zu_bzw_abnahme_der_bev_f6_lkerung_2015_wanderungssaldo_je_1000_einwohner, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;% 
  mutate(sgbii = str_replace(empfanger_innen_von_leistungen_nach_sgb_ii_am_31_12_2016_insgesamt_je_1000_einwohner, &quot;,&quot;, &quot;.&quot;) %&gt;% as.numeric) %&gt;% 
  filter(!(str_detect(wahlkreis_name, &quot;insgesamt|Insgesamt&quot;))) %&gt;% 
  select(wahlkreis_nr, unemployment, wanderung, sgbii, wahlkreis_name, land) %&gt;%
  mutate(wahlkreis_nr = as.integer(wahlkreis_nr))

btw17_data &lt;- btw17 %&gt;% 
  left_join(strukturdaten17) %&gt;% 
  select(-kreis, -wahlkreis_name) %&gt;% 
  left_join(district_names)

tidytemplate::save_it(btw17_data)

btw17_data
</code></pre>

<pre><code>## # A tibble: 299 x 15
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt;   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1       1 1704~     6.84    0.205     23.7       8.21
##  2            2       1 1380~     6.54    0.218     22.5       6.22
##  3            3       1 1308~     8.54    0.360     22.7       6.67
##  4            4       1 1562~     7.41    0.196     22.9       6.37
##  5            5       1 1520~     6.91    0.164     23.8      10.2 
##  6            6       1 1305~     8.55    0.367     23.8       6.52
##  7            7       1 1863~     8.57    0.239     22.9       7.03
##  8            8       1 1919~     8.94    0.241     22.4       6.90
##  9            9       1 1372~     8.58    0.219     24.6       6.05
## 10           10       1 1919~     9.79    0.256     22.3       6.50
## # ... with 289 more rows, and 8 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, unemployment &lt;dbl&gt;,
## #   wanderung &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;
</code></pre>

<h2 id="all-together">All Together</h2>

<pre><code class="language-r">btw13_data &lt;- tidytemplate::load_it(&quot;data/btw13_data.Rdata&quot;)
btw17_data &lt;- tidytemplate::load_it(&quot;data/btw17_data.Rdata&quot;)

btw_data &lt;- bind_rows(btw17_data %&gt;% 
  mutate(year = &quot;BTW 2017&quot;) %&gt;% 
  mutate(part_of = as.character(part_of)),
  btw13_data %&gt;% 
    mutate(year = &quot;BTW 2013&quot;))  %&gt;% 
  mutate(east_west = case_when(
    str_detect(land, &quot;Berlin|Brand|Nieder|Sachs&quot;) ~ &quot;East Germany&quot;,
    T ~ &quot;West Germany&quot;
  )) 

tidytemplate::save_it(btw_data)

btw_data
</code></pre>

<pre><code>## # A tibble: 598 x 17
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 1       1704~     6.84    0.205     23.7       8.21
##  2            2 1       1380~     6.54    0.218     22.5       6.22
##  3            3 1       1308~     8.54    0.360     22.7       6.67
##  4            4 1       1562~     7.41    0.196     22.9       6.37
##  5            5 1       1520~     6.91    0.164     23.8      10.2 
##  6            6 1       1305~     8.55    0.367     23.8       6.52
##  7            7 1       1863~     8.57    0.239     22.9       7.03
##  8            8 1       1919~     8.94    0.241     22.4       6.90
##  9            9 1       1372~     8.58    0.219     24.6       6.05
## 10           10 1       1919~     9.79    0.256     22.3       6.50
## # ... with 588 more rows, and 10 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, unemployment &lt;dbl&gt;,
## #   wanderung &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;, year &lt;chr&gt;,
## #   east_west &lt;chr&gt;
</code></pre>

<h3 id="unemployment">Unemployment</h3>

<h4 id="afd">AfD</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_afd ~ unemployment, data = btw13_data)
mod17 &lt;- lm(perc_afd ~ unemployment, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_afd &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_afd)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 34, x = 8, label = text), show.legend = F) +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share AfD in %&quot;,
       title = &quot;AfD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_afd
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_afd, width = 10, height = 6)
</code></pre>

<h5 id="east-west">East-West</h5>

<pre><code class="language-r">gg_afd_eastwest &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_afd, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share AfD in %&quot;,
       title = &quot;AfD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;) +
  guides(shape = F)

gg_afd_eastwest
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_afd_eastwest, width = 10, height = 6)
</code></pre>

<h4 id="npd">NPD</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_npd ~ unemployment, data = btw13_data)
mod17 &lt;- lm(perc_npd ~ unemployment, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_npd &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_npd)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 5.2, x = 8, label = text), show.legend = F) +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share npd in %&quot;,
       title = &quot;NPD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_npd
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_npd, width = 10, height = 6)
</code></pre>

<h5 id="east-west-1">East-West</h5>

<pre><code class="language-r">gg_npd_eastwest &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_npd, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share npd in %&quot;,
       title = &quot;NPD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;)  +
  guides(shape = F)

gg_npd_eastwest
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_npd_eastwest, width = 10, height = 6)
</code></pre>

<h4 id="linke">Linke</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_linke ~ unemployment, data = btw13_data)
mod17 &lt;- lm(perc_linke ~ unemployment, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;unemployment&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_linke &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_linke)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 34, x = 8, label = text), show.legend = F) +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share 'Die Linke' in %&quot;,
       title = &quot;'Die Linke' Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_linke
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_linke, width = 10, height = 6)
</code></pre>

<h5 id="east-west-2">East-West</h5>

<pre><code class="language-r">gg_linke_eastwest &lt;- btw_data %&gt;% 
  ggplot(aes(unemployment, perc_linke, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Unemployment Rate in %&quot;, y = &quot;Vote Share 'Die Linke in %&quot;,
       title = &quot;'Die Linke' Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;)  +
  guides(shape = F)

gg_linke_eastwest
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_linke_eastwest, width = 10, height = 6)
</code></pre>

<h3 id="migration">Migration</h3>

<h4 id="afd-1">AfD</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_afd ~ wanderung, data = btw13_data)
mod17 &lt;- lm(perc_afd ~ wanderung, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_afd_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_afd)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 34, x = 15, label = text), show.legend = F) +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share AfD in %&quot;,
       title = &quot;AfD Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_afd_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_afd_wanderung, width = 10, height = 6)
</code></pre>

<h5 id="east-west-3">East-West</h5>

<pre><code class="language-r">gg_afd_eastwest_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_afd, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share AfD in %&quot;,
       title = &quot;AfD Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;) +
  guides(shape = F)

gg_afd_eastwest_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_afd_eastwest_wanderung, width = 10, height = 6)
</code></pre>

<h5 id="just-btw-2017">Just BTW 2017</h5>

<pre><code class="language-r">gg_afd_wanderung17 &lt;- btw_data %&gt;% 
  filter(year == &quot;BTW 2017&quot;) %&gt;% 
  ggplot(aes(wanderung, perc_afd, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  theme_minimal() +
  # geom_text(data = label_dat %&gt;% 
  #             filter(year == &quot;BTW 2017&quot;), aes(y = 34, x = 15, label = text), show.legend = F) +
  labs(x = &quot;Net Migration per 1000 inhabitants&quot;, y = &quot;Vote Share AfD in %&quot;,
       title = &quot;AfD Vote Share and Net Migration in the 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)   +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;) +
  guides(shape = F)

gg_afd_wanderung17
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_afd_wanderung17, width = 10, height = 6)
</code></pre>

<h4 id="npd-1">NPD</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_npd ~ wanderung, data = btw13_data)
mod17 &lt;- lm(perc_npd ~ wanderung, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_npd_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_npd)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 5.2, x = 15, label = text), show.legend = F) +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share NPD in %&quot;,
       title = &quot;NPD Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_npd_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_npd_wanderung, width = 10, height = 6)
</code></pre>

<h5 id="east-west-4">East-West</h5>

<pre><code class="language-r">gg_npd_eastwest_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_npd, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share NPD in %&quot;,
       title = &quot;NPD Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;)  +
  guides(shape = F)

gg_npd_eastwest_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_npd_eastwest_wanderung, width = 10, height = 6)
</code></pre>

<h4 id="linke-1">Linke</h4>

<pre><code class="language-r">mod13 &lt;- lm(perc_linke ~ wanderung, data = btw13_data)
mod17 &lt;- lm(perc_linke ~ wanderung, data = btw17_data)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;wanderung&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_linke_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_linke)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 34, x = 15, label = text), show.legend = F) +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share 'Die Linke' in %&quot;,
       title = &quot;'Die Linke' Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_linke_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_linke_wanderung, width = 10, height = 6)
</code></pre>

<h5 id="east-west-5">East-West</h5>

<pre><code class="language-r">gg_linke_eastwest_wanderung &lt;- btw_data %&gt;% 
  ggplot(aes(wanderung, perc_linke, color = east_west)) +
  geom_point(aes(shape = east_west), alpha = 0.8) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  labs(x = &quot;Migration Saldo&quot;, y = &quot;Vote Share 'Die Linke in %&quot;,
       title = &quot;'Die Linke' Vote Share and Net Migration in the 2013 and 2017 German Elections&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;)  +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;)  +
  guides(shape = F)

gg_linke_eastwest_wanderung
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_linke_eastwest_wanderung, width = 10, height = 6)
</code></pre>

<h2 id="where-did-the-afd-come-from">Where did the AfD come from?</h2>

<pre><code class="language-r">btw_lagged_all &lt;- btw_data %&gt;% 
  filter(year == &quot;BTW 2017&quot;) %&gt;%
  select(wahlkreis_nr, perc_afd) %&gt;% 
left_join(
  btw_data %&gt;% 
  filter(year == &quot;BTW 2013&quot;) %&gt;%
  select(wahlkreis_nr, perc_spd, perc_cdu_csu, perc_linke, 
         perc_grun, perc_fdp, perc_npd))  %&gt;% 
  rename(`AfD 2017` = perc_afd,
         `SPD 2013` = perc_spd,
         `CDU/CSU 2013` = perc_cdu_csu,
         `Die Linke 2013` = perc_linke,
         `Die Grünen 2013` = perc_grun,
         `FDP 2013` = perc_fdp,
         `NPD 2013` = perc_npd) %&gt;% 
left_join(
  btw_data %&gt;% select(wahlkreis_nr, east_west)) %&gt;% 
  select(-wahlkreis_nr) 

btw_lagged_all
</code></pre>

<pre><code>## # A tibble: 598 x 8
##    `AfD 2017` `SPD 2013` `CDU/CSU 2013` `Die Linke 2013` `Die Grünen 201~
##         &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1       6.84       32.6           38.2             5.66             9.79
##  2       6.84       32.6           38.2             5.66             9.79
##  3       6.54       29.7           43.4             4.41             8.11
##  4       6.54       29.7           43.4             4.41             8.11
##  5       8.54       30.0           41.9             5.03             7.59
##  6       8.54       30.0           41.9             5.03             7.59
##  7       7.41       31.5           40.8             4.36             9.26
##  8       7.41       31.5           40.8             4.36             9.26
##  9       6.91       34.7           30.3             6.91            14.1 
## 10       6.91       34.7           30.3             6.91            14.1 
## # ... with 588 more rows, and 3 more variables: `FDP 2013` &lt;dbl&gt;, `NPD
## #   2013` &lt;dbl&gt;, east_west &lt;chr&gt;
</code></pre>

<pre><code class="language-r">afd_origin &lt;- btw_lagged_all %&gt;% 
  gather(parties, perc, -east_west, -`AfD 2017`) %&gt;% 
  ggplot(aes(perc, `AfD 2017`, 
             color = east_west, 
             shape = east_west)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~parties, scales = &quot;free&quot;) +
  ggthemes::scale_color_colorblind(&quot;Region&quot;) +
  theme_minimal()  +
  labs(x = &quot;2013 Vote Share in Percent&quot;, 
       y = &quot;AfD Vote Share in 2017&quot;,
       title = &quot;Where did AfD voters come from?&quot;, 
       subtitle = &quot;Comparing 2013 Election results with Vote Share of the AfD in the 2017 Election on the Electoral District Level&quot;,
       caption = &quot;N = 299 Electoral Districts\nData from Federal Returning Officer ('Bundeswahlleiter')\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;),
        legend.position = &quot;bottom&quot;) +
  guides(shape = F) #+
  # ggpubr::stat_cor()

afd_origin
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(afd_origin, width = 12, height = 8)
</code></pre>

<p><strong>To-Do</strong></p>

<h2 id="mapping">mapping</h2>

<pre><code class="language-r">btw_data &lt;- tidytemplate::load_it(&quot;data/btw_data.Rdata&quot;)

library(rgdal)
btw_raw &lt;- readOGR(&quot;data/Geometrie_Wahlkreise_19DBT_geo.shp&quot;) 
</code></pre>

<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\Fabio\Documents\git_proj\btw_data\data\Geometrie_Wahlkreise_19DBT_geo.shp&quot;, layer: &quot;Geometrie_Wahlkreise_19DBT_geo&quot;
## with 299 features
## It has 4 fields
## Integer64 fields read as strings:  WKR_NR
</code></pre>

<pre><code class="language-r">plot(btw_raw)
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">btw_map_dat &lt;- btw_raw@data%&gt;% 
  as.data.frame() %&gt;% 
  rownames_to_column(&quot;id&quot;)

btw_map_wt &lt;- spTransform(btw_raw, CRS(&quot;+proj=longlat +datum=WGS84&quot;))

btw_map &lt;- fortify(btw_map_wt) %&gt;% 
  left_join(btw_map_dat, by = &quot;id&quot;)


btw_map13 &lt;- btw_data %&gt;% 
  filter(year == &quot;BTW 2013&quot;) %&gt;% 
  inner_join(btw_map %&gt;% 
  rename(wahlkreis_nr = WKR_NR) %&gt;% 
  mutate(wahlkreis_nr = as.character(wahlkreis_nr) %&gt;% as.integer))

btw_map17 &lt;- btw_data %&gt;% 
  filter(year == &quot;BTW 2017&quot;) %&gt;% 
  inner_join(btw_map %&gt;% 
  rename(wahlkreis_nr = WKR_NR) %&gt;% 
  mutate(wahlkreis_nr = as.character(wahlkreis_nr) %&gt;% as.integer))


# btw_map &lt;- bind_rows(btw_map13 %&gt;% 
#             mutate(year = &quot;BTW 2013&quot;), 
#           btw_map17 %&gt;% 
#             mutate(year = &quot;BTW 2017&quot;))
</code></pre>

<pre><code class="language-r">btw_map &lt;- bind_rows(btw_map13 %&gt;% 
            mutate(year = &quot;BTW 2013&quot;), 
          btw_map17 %&gt;% 
            mutate(year = &quot;BTW 2017&quot;))

gg_btw_map17 &lt;- btw_map17 %&gt;% 
  ggplot(aes(fill = perc_afd)) +
  geom_map(map = btw_map17,
         aes(x = long, y = lat, group = group, map_id = id),
         color = &quot;black&quot;, size = 0.4)  + 
  theme_void() +
  # facet_wrap(~year) +
  coord_map() +
  viridis::scale_fill_viridis(&quot;AfD Vote Share in %&quot;,
                               option = &quot;D&quot;, discrete = F, end = .8) +
                       #       limits = c(1, 10),
                       # breaks = c(1:10),
                       # labels = c(1:10)) +
  theme(plot.title = element_text(hjust = 0.5, size = 19, face = &quot;bold&quot;),
    legend.justification = c(1, 0),
    legend.position = c(0.82, 0.91),
    legend.title = element_text(size = 16, face = &quot;bold&quot;), 
    strip.text = element_text(size = 12),
    #axis.ticks.length = unit(3, &quot;cm&quot;),
    legend.direction = &quot;horizontal&quot;,
    plot.caption = element_text(size = 13)) +
  guides(fill = guide_colorbar(barwidth = 12, barheight = 0.5,
                title.position = &quot;top&quot;, title.hjust = 0.5,
                label.theme = element_text(colour = &quot;black&quot;, size = 14, angle = 0))) +
  labs(title = &quot;German General Election 2017 - AfD Results&quot;, 
       caption = &quot;299 Electoral Districts   \nData from Federal Returning Officer ('Bundeswahlleiter')   \n@FabioFavusMaxim; favstats.eu   &quot;)

gg_btw_map17
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_btw_map17, width = 8, height = 12)
</code></pre>

<pre><code class="language-r">btw_map &lt;- bind_rows(btw_map13 %&gt;% 
            mutate(year = &quot;BTW 2013&quot;), 
          btw_map17 %&gt;% 
            mutate(year = &quot;BTW 2017&quot;))

gg_btw_map &lt;- btw_map %&gt;% 
  ggplot(aes(fill = perc_afd)) +
  geom_map(map = btw_map17,
         aes(x = long, y = lat, group = group, map_id = id),
         color = &quot;black&quot;, size = 0.4)  + 
  theme_void() +
  facet_wrap(~year) +
  coord_map() +
  viridis::scale_fill_viridis(&quot;AfD Vote Share in %&quot;,
                               option = &quot;D&quot;, discrete = F, end = .8) +
                       #       limits = c(1, 10),
                       # breaks = c(1:10),
                       # labels = c(1:10)) +
  theme(plot.title = element_text(hjust = 0.5, size = 19, face = &quot;bold&quot;),
    legend.justification = c(1, 0),
    legend.position = c(.63, 0.91),
    legend.title = element_text(size = 12, face = &quot;bold&quot;), 
    strip.text = element_text(size = 13),
    plot.margin=unit(c(0,0,0,0),&quot;mm&quot;),
    #axis.ticks.length = unit(3, &quot;cm&quot;),
    legend.direction = &quot;horizontal&quot;,
    plot.caption = element_text(size = 13)) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
                title.position = &quot;top&quot;, title.hjust = 0.5,
                label.theme = element_text(colour = &quot;black&quot;, size = 11, angle = 0))) +
  labs(title = &quot;German General Elections 2013 and 2017 - AfD Results\n&quot;, 
       caption = &quot;299 Electoral Districts   \nData from Federal Returning Officer ('Bundeswahlleiter')   \n@FabioFavusMaxim; favstats.eu   &quot;)

gg_btw_map
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_btw_map, width = 8, height = 8)
</code></pre>

<pre><code class="language-r">gg_btw_map_blue &lt;- btw_map %&gt;% 
  ggplot(aes(fill = perc_afd)) +
  geom_map(map = btw_map17,
         aes(x = long, y = lat, group = group, map_id = id),
         color = &quot;black&quot;, size = 0.4)  + 
  theme_void() +
  facet_wrap(~year) +
  coord_map() +
  scale_fill_continuous(&quot;AfD Vote Share in %&quot;, 
                        low = &quot;#00b4ff&quot;, 
                        high = &quot;#002f42&quot;) +
  theme(plot.title = element_text(hjust = 0.5, size = 19, face = &quot;bold&quot;),
    legend.justification = c(1, 0),
    legend.position = c(.63, 0.91),
    legend.title = element_text(size = 12, face = &quot;bold&quot;), 
    strip.text = element_text(size = 13),
    plot.margin=unit(c(0,0,0,0),&quot;mm&quot;),
    #axis.ticks.length = unit(3, &quot;cm&quot;),
    legend.direction = &quot;horizontal&quot;,
    plot.caption = element_text(size = 13)) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
                title.position = &quot;top&quot;, title.hjust = 0.5,
                label.theme = element_text(colour = &quot;black&quot;, size = 11, angle = 0))) +
  labs(title = &quot;German General Elections 2013 and 2017 - AfD Results\n&quot;, 
       caption = &quot;299 Electoral Districts   \nData from Federal Returning Officer ('Bundeswahlleiter')   \n@FabioFavusMaxim; favstats.eu   &quot;)

gg_btw_map_blue
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_btw_map_blue, width = 8, height = 8)
</code></pre>

<pre><code class="language-r">btw_map17_unemp &lt;- btw_map17 %&gt;% 
  ggplot(aes(fill = unemployment)) +
  geom_map(map = btw_map17,
         aes(x = long, y = lat, group = group, map_id = id),
         color = &quot;black&quot;, size = 0.4)  + 
  theme_void() +
  # facet_wrap(~year) +
  coord_map() +
  viridis::scale_fill_viridis(&quot;Unemplyoment in %&quot;,
                               option = &quot;D&quot;, discrete = F, end = .8) +
                       #       limits = c(1, 10),
                       # breaks = c(1:10),
                       # labels = c(1:10)) +
  theme(plot.title = element_text(hjust = 0.5, size = 19, face = &quot;bold&quot;),
    legend.justification = c(1, 0),
    legend.position = c(0.3, 0.82),
    legend.title = element_text(size = 10, face = &quot;bold&quot;), strip.text = element_text(size = 12),
    #axis.ticks.length = unit(3, &quot;cm&quot;),
    legend.direction = &quot;horizontal&quot;) +
  guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
                title.position = &quot;top&quot;, title.hjust = 0.5,
                label.theme = element_text(colour = &quot;black&quot;, size = 5, angle = 0)))

btw_map17_unemp
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(btw_map17_unemp, width = 8, height = 12)
</code></pre>

<h2 id="gganimate">gganimate</h2>

<pre><code class="language-r"># library(gganimate)
# 
# btw_data %&gt;% 
#   ggplot(aes(unemployment, perc_afd, color = year)) +
#   geom_point() +
#   geom_smooth(method = &quot;lm&quot;) +
#   transition_states(year, transition_length = 10, state_length = 4)
</code></pre>

<pre><code class="language-r"># btw_map_anim &lt;- btw_map %&gt;% 
#   ggplot(aes(fill = perc_afd)) +
#   geom_map(map = btw_map,
#          aes(x = long, y = lat, group = group, map_id = id),
#          color = &quot;black&quot;, size = 0.4)  + 
#   theme_void() +
#   coord_map() +
#   geom_text(aes(x = 7, y = 55, 
#                 label = paste0(&quot;Year: &quot;, year)), size = 7) +
#   viridis::scale_fill_viridis(&quot;AfD Vote Share in %&quot;,
#                                option = &quot;D&quot;, discrete = F, end = .8) +
#                        #       limits = c(1, 10),
#                        # breaks = c(1:10),
#                        # labels = c(1:10)) +
#   theme(plot.title = element_text(hjust = 0.5, size = 19, face = &quot;bold&quot;),
#     legend.justification = c(1, 0),
#     legend.position = c(0.82, 0.91),
#     legend.title = element_text(size = 16, face = &quot;bold&quot;), 
#     strip.text = element_text(size = 12),
#     #axis.ticks.length = unit(3, &quot;cm&quot;),
#     legend.direction = &quot;horizontal&quot;,
#     plot.caption = element_text(size = 13)) +
#   guides(fill = guide_colorbar(barwidth = 12, barheight = 0.5,
#                 title.position = &quot;top&quot;, title.hjust = 0.5,
#                 label.theme = element_text(colour = &quot;black&quot;, size = 14, angle = 0))) +
#   labs(title = &quot;German General Elections - AfD Results&quot;, 
#        caption = &quot;299 Electoral Districts   \nData from Federal Returning Officer ('Bundeswahlleiter')   \n@FabioFavusMaxim; favstats.eu   &quot;) +
#   transition_states(year, transition_length = 10, state_length = 4)
# 
# # btw_map_anim
# 
# # tidytemplate::ggsave_it(btw_map_anim, width = 8, height = 12)
# 
# btw_map_anim %&gt;% animate(
#   nframes = 100, fps = 15, width = 666.6667, height = 1000, detail = 1
# )
# 
# anim_save(&quot;images/btw_map_anim.gif&quot;)
</code></pre>

<h2 id="ggally">GGally</h2>

<pre><code class="language-r">pacman::p_load(GGally)

plot_lagged_all &lt;- btw_lagged_all %&gt;% 
  ggpairs(lower = list(continuous = &quot;smooth&quot;),
   mapping = aes(color = east_west)) +
  labs(title = &quot;Where did AfD voters come from?&quot;, 
       caption = &quot;N = 299 Electoral Districts\nData from bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))


for(i in 1:plot_lagged_all$nrow) {
  for(j in 1:plot_lagged_all$ncol){
    plot_lagged_all[i,j] &lt;- plot_lagged_all[i,j] + ggthemes::scale_color_fivethirtyeight() 
  }
}

plot_lagged_all
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-26-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(plot_lagged_all, width = 15, height = 13)
</code></pre>

<h2 id="sgb-ii">SGB II</h2>

<pre><code class="language-r">btw_data &lt;- bind_rows(btw17_data %&gt;% 
  mutate(year = &quot;BTW 2017&quot;) %&gt;% 
  mutate(part_of = as.character(part_of)),
  btw13_data %&gt;% 
    mutate(year = &quot;BTW 2013&quot;)) 

mod13 &lt;- lm(perc_npd ~ sgbii, data = btw13_data)
mod17 &lt;- lm(perc_npd ~ sgbii, data = btw17_data)

options(scipen = 999)

r2_13 &lt;- get_r2_label(mod13)
r2_17 &lt;- get_r2_label(mod17)

label_dat &lt;- tibble(year = c(&quot;BTW 2013&quot;, &quot;BTW 2017&quot;),
     text =   c(
broom::tidy(mod13) %&gt;% 
  filter(term == &quot;sgbii&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_13)) %&gt;% 
  .$text,

broom::tidy(mod17) %&gt;% 
  filter(term == &quot;sgbii&quot;) %&gt;% 
  mutate(text = paste0(&quot;b = &quot;, round(estimate, 2), 
         &quot;, &quot;, get_labs(p.value),
         &quot;, R Squared = &quot;, r2_17)) %&gt;% 
  .$text
))

gg_npd_sgbii &lt;- btw_data %&gt;% 
  ggplot(aes(sgbii, perc_npd)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  facet_wrap(~year) +
  theme_minimal() +
  geom_text(data = label_dat, aes(y = 5, x = 100, label = text), show.legend = F) +
  labs(x = &quot;sgbii Rate in %&quot;, 
       y = &quot;Vote Share npd in %&quot;,
       title = &quot;npd Vote Share and sgbii Rate in the 2013 and 2017 German Elections&quot;, 
       caption = &quot;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&quot;) +
  theme(title = element_text(face = &quot;bold&quot;), 
        strip.background = element_rect(fill = &quot;lightgrey&quot;), 
        strip.text = element_text(face = &quot;bold&quot;))

gg_npd_sgbii
</code></pre>

<p><img src="https://raw.githubusercontent.com/favstats/btw_data/master/btw_data_files/figure-gfm/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /></p>

<pre><code class="language-r">tidytemplate::ggsave_it(gg_npd_sgbii, width = 10, height = 6)
</code></pre>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/elections">elections</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/dataviz">dataviz</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/temperature_viz/">Visualizing Temperature Rise in Stuttgart, Germany over Time</a></li>
    
    <li><a href="/post/multicol_sim/">How does Collinearity Influence Linear Regressions?</a></li>
    
    <li><a href="/post/ecprconf18/">Analyzing Tweets of the ECPR General Conference 2018</a></li>
    
    <li><a href="/post/tidylocations/">Mapping your 2017 Geolocations: The Tidy Way</a></li>
    
    <li><a href="/post/terror_map/">Mapping Terror Attacks with Highcharter</a></li>
    
  </ul>
</div>




<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-favstats-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2019 Fabio Votta &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//https-favstats-netlify-com.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

