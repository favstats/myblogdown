<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.69.2" />
  <meta name="author" content="Fabio Votta">
  <meta name="description" content="Empirical Social and Political Research">

  
  <link rel="alternate" hreflang="en-us" href="/post/btw_map/">

  
  


  

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-121993278-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="favstats - personal blog">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/btw_map/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@https://twitter.com/favstats">
  <meta property="twitter:creator" content="@https://twitter.com/favstats">
  
  <meta property="og:site_name" content="favstats - personal blog">
  <meta property="og:url" content="/post/btw_map/">
  <meta property="og:title" content="Visualizing Results of German Elections (2013 and 2017) | favstats - personal blog">
  <meta property="og:description" content=""><meta property="og:image" content="/img/headers/election_map.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-09-19T00:00:00&#43;02:00">
  
  <meta property="article:modified_time" content="2018-09-19T00:00:00&#43;02:00">
  

  

  <title>Visualizing Results of German Elections (2013 and 2017) | favstats - personal blog</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/logo.png" alt="favstats - personal blog"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#awards">
            
            <span>Awards</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/election_map.png" class="article-banner" itemprop="image">
  <span class="article-header-caption">AfD Results of the 2013 and 2017 German Elections</span>
</div>



  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Visualizing Results of German Elections (2013 and 2017)</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-09-19 00:00:00 &#43;0200 CEST" itemprop="datePublished">
      Sep 19, 2018
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    23 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/btw_map/#disqus_thread"></a>
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29&amp;url=%2fpost%2fbtw_map%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fbtw_map%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fbtw_map%2f&amp;title=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fbtw_map%2f&amp;title=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Visualizing%20Results%20of%20German%20Elections%20%282013%20and%202017%29&amp;body=%2fpost%2fbtw_map%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <p>Data
Sources:</p>
<p><a href="https://www.govdata.de/web/guest/apps/-/details/bundestagswahl-2017">https://www.govdata.de/web/guest/apps/-/details/bundestagswahl-2017</a></p>
<p><a href="https://www.bundeswahlleiter.de/bundestagswahlen/2017/strukturdaten.html">https://www.bundeswahlleiter.de/bundestagswahlen/2017/strukturdaten.html</a></p>
<h2 id="settings-packages-and-folders">Settings, Packages and Folders</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">options</span>(scipen <span style="color:#f92672">=</span> <span style="color:#ae81ff">999</span>)
knitr<span style="color:#f92672">::</span>opts_chunk<span style="color:#f92672">$</span><span style="color:#a6e22e">set</span>(message <span style="color:#f92672">=</span> F,  warning <span style="color:#f92672">=</span> F, error <span style="color:#f92672">=</span> F, 
                      fig.align <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;center&#34;</span>, 
                      fig.width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, fig.height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
<span style="color:#75715e"># Install these packages if you don&#39;t have theme yet</span>
<span style="color:#75715e"># devtools::install_github(&#34;favstats/tidytemplate&#34;)</span>
<span style="color:#75715e"># install.packages(&#34;pacman&#34;)</span>

pacman<span style="color:#f92672">::</span><span style="color:#a6e22e">p_load</span>(tidyverse)

<span style="color:#75715e"># Creates folders</span>
<span style="color:#75715e"># tidytemplate::data_dir()</span>
<span style="color:#75715e"># tidytemplate::images_dir()</span>
</code></pre></div><h2 id="helper-functions">Helper Functions</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">get_percentage <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(part, total, digits <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>) {

  <span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.numeric</span>(part) <span style="color:#f92672">|</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">is.numeric</span>(total)){
    <span style="color:#a6e22e">cat</span>(<span style="color:#e6db74">&#34;Non-numeric variables.. converting\n&#34;</span>)
    part <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(part)
    total <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.numeric</span>(total)
  }
   val <span style="color:#f92672">&lt;-</span> part <span style="color:#f92672">/</span> total <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
   <span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.null</span>(digits)){
   val <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">round</span>(val, digits)
   }
  <span style="color:#a6e22e">return</span>(val) 
}


get_labs <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function </span>(pval) 
{
  dplyr<span style="color:#f92672">::</span><span style="color:#a6e22e">case_when</span>(<span style="color:#a6e22e">is.na</span>(pval) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;&#34;</span>, 
                   pval <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.001</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;p &lt; 0.001&#34;</span>,
                   pval <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.01</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;p &lt; 0.01&#34;</span>, 
                   pval <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.05</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;p &lt; 0.05&#34;</span>, 
                   pval <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.1</span> <span style="color:#f92672">~</span>  <span style="color:#e6db74">&#34;p &lt; 0.10&#34;</span>, 
      <span style="color:#66d9ef">TRUE</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;p &gt; 0.10&#34;</span>)
}


get_r2_label <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(mod, digits <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, adj <span style="color:#f92672">=</span> F){
  <span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span>adj){<span style="color:#75715e">#</span>
    <span style="color:#a6e22e">message</span>(<span style="color:#e6db74">&#34;R Squared\n&#34;</span>)
r2 <span style="color:#f92672">&lt;-</span> broom<span style="color:#f92672">::</span><span style="color:#a6e22e">glance</span>(mod) <span style="color:#f92672">%&gt;%</span>
    <span style="color:#a6e22e">mutate</span>(r.squared <span style="color:#f92672">=</span> r.squared <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>) <span style="color:#f92672">%&gt;%</span> 
    .$r.squared <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">format</span>(., digits <span style="color:#f92672">=</span> digits) <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">paste0</span>(., <span style="color:#e6db74">&#34;%&#34;</span>)
<span style="color:#a6e22e">return</span>(r2)
  } else {
    <span style="color:#a6e22e">message</span>(<span style="color:#e6db74">&#34;Getting Adjusted R Squared\n&#34;</span>)
    r2 <span style="color:#f92672">&lt;-</span> broom<span style="color:#f92672">::</span><span style="color:#a6e22e">glance</span>(mod) <span style="color:#f92672">%&gt;%</span>
      <span style="color:#a6e22e">mutate</span>(adj.r.squared <span style="color:#f92672">=</span> adj.r.squared <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>) <span style="color:#f92672">%&gt;%</span> 
      .$adj.r.squared <span style="color:#f92672">%&gt;%</span> 
      <span style="color:#a6e22e">format</span>(., digits <span style="color:#f92672">=</span> digits) <span style="color:#f92672">%&gt;%</span> 
      <span style="color:#a6e22e">paste0</span>(., <span style="color:#e6db74">&#34;%&#34;</span>)    
<span style="color:#a6e22e">return</span>(r2)
  }
}
</code></pre></div><h2 id="load-data">Load Data</h2>
<h3 id="btw13">BTW13</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e">## loading in district names</span>
district_names <span style="color:#f92672">&lt;-</span> tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">load_it</span>(<span style="color:#e6db74">&#34;data/district_names.Rdata&#34;</span>)


vars13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;wahlkreis_nr&#34;</span>, <span style="color:#e6db74">&#34;kreis&#34;</span>, <span style="color:#e6db74">&#34;part_of&#34;</span>, <span style="color:#e6db74">&#34;valid&#34;</span>, <span style="color:#e6db74">&#34;CDU&#34;</span>, <span style="color:#e6db74">&#34;SPD&#34;</span>, <span style="color:#e6db74">&#34;FDP&#34;</span>, <span style="color:#e6db74">&#34;DIE LINKE&#34;</span>, <span style="color:#e6db74">&#34;GRÜNE&#34;</span>, <span style="color:#e6db74">&#34;CSU&#34;</span>, <span style="color:#e6db74">&#34;PIRATEN&#34;</span>, <span style="color:#e6db74">&#34;NPD&#34;</span>, <span style="color:#e6db74">&#34;Tierschutzpartei&#34;</span>, <span style="color:#e6db74">&#34;REP&#34;</span>, <span style="color:#e6db74">&#34;ÖDP&#34;</span>, <span style="color:#e6db74">&#34;FAMILIE&#34;</span>, <span style="color:#e6db74">&#34;Bündnis 21/RRP&#34;</span>, <span style="color:#e6db74">&#34;RENTNER&#34;</span>, <span style="color:#e6db74">&#34;BP&#34;</span>, <span style="color:#e6db74">&#34;PBC&#34;</span>, <span style="color:#e6db74">&#34;BüSo&#34;</span>, <span style="color:#e6db74">&#34;DIE VIOLETTEN&#34;</span>, <span style="color:#e6db74">&#34;MLPD&#34;</span>, <span style="color:#e6db74">&#34;Volksabstimmung&#34;</span>, <span style="color:#e6db74">&#34;PSG&#34;</span>, <span style="color:#e6db74">&#34;AfD&#34;</span>, <span style="color:#e6db74">&#34;BIG&#34;</span>, <span style="color:#e6db74">&#34;pro Deutschland&#34;</span>, <span style="color:#e6db74">&#34;DIE RECHTE&#34;</span>, <span style="color:#e6db74">&#34;DIE FRAUEN&#34;</span>, <span style="color:#e6db74">&#34;FREIE WÄHLER&#34;</span>, <span style="color:#e6db74">&#34;Nichtwähler&#34;</span>, <span style="color:#e6db74">&#34;PARTEI DER VERNUNFT&#34;</span>, <span style="color:#e6db74">&#34;Die PARTEI&#34;</span>, <span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#e6db74">&#34;BGD&#34;</span>, <span style="color:#e6db74">&#34;DKP&#34;</span>, <span style="color:#e6db74">&#34;NEIN!&#34;</span>, <span style="color:#e6db74">&#34;Übrige&#34;</span>)

 <span style="color:#75715e"># ss %&gt;% </span>

btw13 <span style="color:#f92672">&lt;-</span> readr<span style="color:#f92672">::</span><span style="color:#a6e22e">read_delim</span>(<span style="color:#e6db74">&#34;data/btw13_kerg.csv&#34;</span>, 
                           <span style="color:#e6db74">&#34;;&#34;</span>, escape_double <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, 
                           comment <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#&#34;</span>, 
                           trim_ws <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)  <span style="color:#f92672">%&gt;%</span> 
  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(nr, gebiet, geh_f6_rt, <span style="color:#a6e22e">str_which</span>(pattern <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Endg&lt;fc&gt;ltig&#34;</span>, .)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(nr, gebiet, geh_f6_rt, <span style="color:#a6e22e">str_which</span>(pattern <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Zweitstimme&#34;</span>, .))  <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>x6, <span style="color:#f92672">-</span>x10, <span style="color:#f92672">-</span>x14) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">set_names</span>(vars13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(cdu_csu <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">is.na</span>(CDU), CSU, CDU)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(perc_cdu_csu <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(cdu_csu, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_spd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(SPD, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_linke <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`DIE LINKE`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_fdp <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(FDP, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_grun <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`GRÜNE`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_afd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(AfD, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(NPD <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">is.na</span>(NPD), <span style="color:#e6db74">&#34;0&#34;</span>, NPD)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(perc_npd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(NPD, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, kreis, part_of, valid, perc_afd, 
         perc_npd, perc_spd, perc_linke, perc_fdp, 
         perc_grun, perc_cdu_csu) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">drop_na</span>(wahlkreis_nr) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(part_of <span style="color:#f92672">!=</span> <span style="color:#ae81ff">99</span>)
</code></pre></div><pre><code>## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">strukturdaten13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_delim</span>(<span style="color:#e6db74">&#34;data/btw13_strukturdaten.csv&#34;</span>, 
                              <span style="color:#e6db74">&#34;;&#34;</span>, escape_double <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>,
                              comment <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#&#34;</span>, 
                              trim_ws <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, 
                              col_types <span style="color:#f92672">=</span> <span style="color:#a6e22e">cols</span>(.default <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c&#34;</span>)) <span style="color:#f92672">%&gt;%</span> 
  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">%&gt;%</span> 
  .[<span style="color:#ae81ff">-1</span>,] <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(unemployment <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(arbeitslosenquote_ende_dezember_2012_insgesamt, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(sgbii <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(empf_e4_nger_innen_von_leistungen_nach_sgb_ii_am_31_12_2012_insgesamt_je_1000_einwohner, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span>   
  <span style="color:#a6e22e">mutate</span>(wanderung <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(zu_bzw_abnahme_der_bev_f6_lkerung_2011_wanderungssaldo_je_1000_einwohner, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span>  
  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span>(<span style="color:#a6e22e">str_detect</span>(wahlkreis_name, <span style="color:#e6db74">&#34;insgesamt|Insgesamt&#34;</span>))) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, wanderung, unemployment, sgbii, wahlkreis_name, land) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(wahlkreis_nr <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.integer</span>(wahlkreis_nr))

btw13_data <span style="color:#f92672">&lt;-</span> btw13 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(strukturdaten13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>kreis, <span style="color:#f92672">-</span>wahlkreis_name) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(district_names)

tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">save_it</span>(btw13_data)

btw13_data
</code></pre></div><pre><code>## # A tibble: 299 x 15
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 1       1606~     4.09    0.578     32.6       5.66
##  2            2 1       1300~     3.84    0.564     29.7       4.41
##  3            3 1       1249~     4.40    0.831     30.0       5.03
##  4            4 1       1479~     4.39    0.577     31.5       4.36
##  5            5 1       1449~     3.71    0.553     34.7       6.91
##  6            6 1       1255~     4.70    0.923     32.7       4.77
##  7            7 1       1773~     4.78    0.744     31.2       5.02
##  8            8 1       1815~     4.97    0.720     30.1       5.02
##  9            9 1       1304~     4.96    0.565     31.5       4.34
## 10           10 1       1814~     5.63    0.759     29.7       4.94
## # ... with 289 more rows, and 8 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, wanderung &lt;dbl&gt;,
## #   unemployment &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;
</code></pre>
<h3 id="btw-17">BTW 17</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">vars17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;wahlkreis_nr&#34;</span>, <span style="color:#e6db74">&#34;kreis&#34;</span>, <span style="color:#e6db74">&#34;part_of&#34;</span>, <span style="color:#e6db74">&#34;valid&#34;</span>, <span style="color:#e6db74">&#34;Christlich Demokratische Union Deutschlands&#34;</span>, <span style="color:#e6db74">&#34;Sozialdemokratische Partei Deutschlands&#34;</span>, <span style="color:#e6db74">&#34;DIE LINKE&#34;</span>, <span style="color:#e6db74">&#34;BÜNDNIS 90/DIE GRÜNEN&#34;</span>, <span style="color:#e6db74">&#34;Christlich-Soziale Union in Bayern e.V.&#34;</span>, <span style="color:#e6db74">&#34;Freie Demokratische Partei&#34;</span>, <span style="color:#e6db74">&#34;Alternative für Deutschland&#34;</span>, <span style="color:#e6db74">&#34;Piratenpartei Deutschland&#34;</span>, <span style="color:#e6db74">&#34;Nationaldemokratische Partei Deutschlands&#34;</span>, <span style="color:#e6db74">&#34;FREIE WÄHLER&#34;</span>, <span style="color:#e6db74">&#34;PARTEI MENSCH UMWELT TIERSCHUTZ&#34;</span>, <span style="color:#e6db74">&#34;Ökologisch-Demokratische Partei&#34;</span>, <span style="color:#e6db74">&#34;Die PARTEI&#34;</span>, <span style="color:#e6db74">&#34;Bayernpartei&#34;</span>, <span style="color:#e6db74">&#34;Ab jetzt...Demokratie durch Volksabstimmung&#34;</span>, <span style="color:#e6db74">&#34;Partei der Vernunft&#34;</span>, <span style="color:#e6db74">&#34;Marxistisch-Leninistische Partei Deutschlands&#34;</span>, <span style="color:#e6db74">&#34;Bürgerrechtsbewegung Solidarität&#34;</span>, <span style="color:#e6db74">&#34;Sozialistische Gleichheitspartei&#34;</span>, <span style="color:#e6db74">&#34;DIE RECHTE&#34;</span>, <span style="color:#e6db74">&#34;Allianz Deutscher Demokraten&#34;</span>, <span style="color:#e6db74">&#34;Allianz für Menschenrechte&#34;</span>, <span style="color:#e6db74">&#34;bergpartei&#34;</span>, <span style="color:#e6db74">&#34;Bündnis Grundeinkommen&#34;</span>, <span style="color:#e6db74">&#34;DEMOKRATIE IN BEWEGUNG&#34;</span>, <span style="color:#e6db74">&#34;Deutsche Kommunistische Partei&#34;</span>, <span style="color:#e6db74">&#34;Deutsche Mitte&#34;</span>, <span style="color:#e6db74">&#34;Die Grauen – Für alle Generationen&#34;</span>, <span style="color:#e6db74">&#34;Die Urbane. Eine HipHop Partei&#34;</span>, <span style="color:#e6db74">&#34;Madgeburger Gartenpartei&#34;</span>, <span style="color:#e6db74">&#34;Menschliche Welt&#34;</span>, <span style="color:#e6db74">&#34;Partei der Humanisten&#34;</span>, <span style="color:#e6db74">&#34;Partei für Gesundheitsforschung&#34;</span>, <span style="color:#e6db74">&#34;V-Partei³ - Partei für Veränderung&#34;</span>, <span style="color:#e6db74">&#34;Bündnis C - Christen für Deutschland&#34;</span>, <span style="color:#e6db74">&#34;DIE EINHEIT&#34;</span>, <span style="color:#e6db74">&#34;Die Violetten&#34;</span>, <span style="color:#e6db74">&#34;Familien-Partei Deutschlands&#34;</span>, <span style="color:#e6db74">&#34;Feministische Partei DIE FRAUEN&#34;</span>, <span style="color:#e6db74">&#34;Mieterpartei&#34;</span>, <span style="color:#e6db74">&#34;Neue Liberale – Die Sozialliberalen&#34;</span>, <span style="color:#e6db74">&#34;UNABHÄNGIGE für bürgernahe Demokratie&#34;</span>, <span style="color:#e6db74">&#34;Übrige&#34;</span>)

btw17 <span style="color:#f92672">&lt;-</span> readr<span style="color:#f92672">::</span><span style="color:#a6e22e">read_delim</span>(<span style="color:#e6db74">&#34;data/btw17_kerg.csv&#34;</span>, 
                           <span style="color:#e6db74">&#34;;&#34;</span>, escape_double <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, comment <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#&#34;</span>, 
                           trim_ws <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)  <span style="color:#f92672">%&gt;%</span> 
  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(nr, gebiet, gehort_zu, <span style="color:#a6e22e">grep</span>(<span style="color:#e6db74">&#34;Endgültig&#34;</span>, .)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(nr, gebiet, gehort_zu, <span style="color:#a6e22e">grep</span>(<span style="color:#e6db74">&#34;Zweitstimme&#34;</span>, .)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>x6, <span style="color:#f92672">-</span>x10, <span style="color:#f92672">-</span>x14) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">set_names</span>(vars17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(cdu_csu <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">is.na</span>(`Christlich Demokratische Union Deutschlands`), 
                          `Christlich-Soziale Union in Bayern e.V.`, 
                          `Christlich Demokratische Union Deutschlands`)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(perc_cdu_csu <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(cdu_csu, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_spd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`Sozialdemokratische Partei Deutschlands`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_linke <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`DIE LINKE`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_fdp <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`Freie Demokratische Partei`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_grun <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`BÜNDNIS 90/DIE GRÜNEN`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(perc_afd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(`Alternative für Deutschland`, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(NPD <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(<span style="color:#a6e22e">is.na</span>(`Nationaldemokratische Partei Deutschlands`), 
                      <span style="color:#e6db74">&#34;0&#34;</span>, 
                      `Nationaldemokratische Partei Deutschlands`)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(perc_npd <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_percentage</span>(NPD, valid)) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, kreis, part_of, valid, perc_afd, 
         perc_npd, perc_spd, perc_linke, perc_fdp, 
         perc_grun, perc_cdu_csu) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">drop_na</span>(wahlkreis_nr) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(part_of <span style="color:#f92672">!=</span> <span style="color:#ae81ff">99</span>)
</code></pre></div><pre><code>## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
## Non-numeric variables.. converting
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw17
</code></pre></div><pre><code>## # A tibble: 299 x 11
##    wahlkreis_nr kreis part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 Flen~       1 1704~     6.84    0.205     23.7       8.21
##  2            2 Nord~       1 1380~     6.54    0.218     22.5       6.22
##  3            3 Stei~       1 1308~     8.54    0.360     22.7       6.67
##  4            4 Rend~       1 1562~     7.41    0.196     22.9       6.37
##  5            5 Kiel        1 1520~     6.91    0.164     23.8      10.2 
##  6            6 Plön~       1 1305~     8.55    0.367     23.8       6.52
##  7            7 Pinn~       1 1863~     8.57    0.239     22.9       7.03
##  8            8 Sege~       1 1919~     8.94    0.241     22.4       6.90
##  9            9 Osth~       1 1372~     8.58    0.219     24.6       6.05
## 10           10 Herz~       1 1919~     9.79    0.256     22.3       6.50
## # ... with 289 more rows, and 3 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">strukturdaten17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read_delim</span>(<span style="color:#e6db74">&#34;data/btw17_strukturdaten.csv&#34;</span>, 
                              <span style="color:#e6db74">&#34;;&#34;</span>, escape_double <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>,
                              col_types <span style="color:#f92672">=</span> <span style="color:#a6e22e">cols</span>(.default <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;c&#34;</span>), 
                              comment <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#&#34;</span>, 
                              trim_ws <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, 
                              skip <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">%&gt;%</span> 
  janitor<span style="color:#f92672">::</span><span style="color:#a6e22e">clean_names</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(unemployment <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(arbeitslosenquote_marz_2017_insgesamt, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(wanderung <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(zu_bzw_abnahme_der_bev_f6_lkerung_2015_wanderungssaldo_je_1000_einwohner, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(sgbii <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>(empfanger_innen_von_leistungen_nach_sgb_ii_am_31_12_2016_insgesamt_je_1000_einwohner, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">%&gt;%</span> as.numeric) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(<span style="color:#f92672">!</span>(<span style="color:#a6e22e">str_detect</span>(wahlkreis_name, <span style="color:#e6db74">&#34;insgesamt|Insgesamt&#34;</span>))) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, unemployment, wanderung, sgbii, wahlkreis_name, land) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">mutate</span>(wahlkreis_nr <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.integer</span>(wahlkreis_nr))

btw17_data <span style="color:#f92672">&lt;-</span> btw17 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(strukturdaten17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>kreis, <span style="color:#f92672">-</span>wahlkreis_name) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(district_names)

tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">save_it</span>(btw17_data)

btw17_data
</code></pre></div><pre><code>## # A tibble: 299 x 15
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt;   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1       1 1704~     6.84    0.205     23.7       8.21
##  2            2       1 1380~     6.54    0.218     22.5       6.22
##  3            3       1 1308~     8.54    0.360     22.7       6.67
##  4            4       1 1562~     7.41    0.196     22.9       6.37
##  5            5       1 1520~     6.91    0.164     23.8      10.2 
##  6            6       1 1305~     8.55    0.367     23.8       6.52
##  7            7       1 1863~     8.57    0.239     22.9       7.03
##  8            8       1 1919~     8.94    0.241     22.4       6.90
##  9            9       1 1372~     8.58    0.219     24.6       6.05
## 10           10       1 1919~     9.79    0.256     22.3       6.50
## # ... with 289 more rows, and 8 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, unemployment &lt;dbl&gt;,
## #   wanderung &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;
</code></pre>
<h2 id="all-together">All Together</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw13_data <span style="color:#f92672">&lt;-</span> tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">load_it</span>(<span style="color:#e6db74">&#34;data/btw13_data.Rdata&#34;</span>)
btw17_data <span style="color:#f92672">&lt;-</span> tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">load_it</span>(<span style="color:#e6db74">&#34;data/btw17_data.Rdata&#34;</span>)

btw_data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(btw17_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(part_of <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(part_of)),
  btw13_data <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>))  <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(east_west <span style="color:#f92672">=</span> <span style="color:#a6e22e">case_when</span>(
    <span style="color:#a6e22e">str_detect</span>(land, <span style="color:#e6db74">&#34;Berlin|Brand|Nieder|Sachs&#34;</span>) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;East Germany&#34;</span>,
    T <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;West Germany&#34;</span>
  )) 

tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">save_it</span>(btw_data)

btw_data
</code></pre></div><pre><code>## # A tibble: 598 x 17
##    wahlkreis_nr part_of valid perc_afd perc_npd perc_spd perc_linke
##           &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1            1 1       1704~     6.84    0.205     23.7       8.21
##  2            2 1       1380~     6.54    0.218     22.5       6.22
##  3            3 1       1308~     8.54    0.360     22.7       6.67
##  4            4 1       1562~     7.41    0.196     22.9       6.37
##  5            5 1       1520~     6.91    0.164     23.8      10.2 
##  6            6 1       1305~     8.55    0.367     23.8       6.52
##  7            7 1       1863~     8.57    0.239     22.9       7.03
##  8            8 1       1919~     8.94    0.241     22.4       6.90
##  9            9 1       1372~     8.58    0.219     24.6       6.05
## 10           10 1       1919~     9.79    0.256     22.3       6.50
## # ... with 588 more rows, and 10 more variables: perc_fdp &lt;dbl&gt;,
## #   perc_grun &lt;dbl&gt;, perc_cdu_csu &lt;dbl&gt;, unemployment &lt;dbl&gt;,
## #   wanderung &lt;dbl&gt;, sgbii &lt;dbl&gt;, land &lt;chr&gt;, kreis &lt;chr&gt;, year &lt;chr&gt;,
## #   east_west &lt;chr&gt;
</code></pre>
<h3 id="unemployment">Unemployment</h3>
<h4 id="afd">AfD</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_afd <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_afd <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_afd <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_afd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">34</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share AfD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_afd
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_afd, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_afd_eastwest <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_afd, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share AfD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_afd_eastwest
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_afd_eastwest, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h4 id="npd">NPD</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_npd <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_npd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">5.2</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share npd in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NPD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_npd
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_npd, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west-1">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_npd_eastwest <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_npd, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share npd in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NPD Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_npd_eastwest
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_npd_eastwest, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h4 id="linke">Linke</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_linke <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_linke <span style="color:#f92672">~</span> unemployment, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;unemployment&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_linke <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_linke)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">34</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share &#39;Die Linke&#39; in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39;Die Linke&#39; Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_linke
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_linke, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west-2">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_linke_eastwest <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(unemployment, perc_linke, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unemployment Rate in %&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share &#39;Die Linke in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39;Die Linke&#39; Vote Share and Unemployment Rate in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_linke_eastwest
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_linke_eastwest, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h3 id="migration">Migration</h3>
<h4 id="afd-1">AfD</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_afd <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_afd <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_afd_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_afd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">34</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share AfD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_afd_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_afd_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west-3">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_afd_eastwest_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_afd, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share AfD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_afd_eastwest_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_afd_eastwest_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="just-btw-2017">Just BTW 2017</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_afd_wanderung17 <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(year <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_afd, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#75715e"># geom_text(data = label_dat %&gt;% </span>
  <span style="color:#75715e">#             filter(year == &#34;BTW 2017&#34;), aes(y = 34, x = 15, label = text), show.legend = F) +</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Net Migration per 1000 inhabitants&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share AfD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share and Net Migration in the 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)   <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_afd_wanderung17
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_afd_wanderung17, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h4 id="npd-1">NPD</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_npd_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_npd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">5.2</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share NPD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NPD Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_npd_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_npd_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west-4">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_npd_eastwest_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_npd, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share NPD in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NPD Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_npd_eastwest_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_npd_eastwest_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h4 id="linke-1">Linke</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_linke <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_linke <span style="color:#f92672">~</span> wanderung, data <span style="color:#f92672">=</span> btw17_data)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;wanderung&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_linke_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_linke)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">34</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share &#39;Die Linke&#39; in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39;Die Linke&#39; Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_linke_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_linke_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h5 id="east-west-5">East-West</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_linke_eastwest_wanderung <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(wanderung, perc_linke, color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(<span style="color:#a6e22e">aes</span>(shape <span style="color:#f92672">=</span> east_west), alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Migration Saldo&#34;</span>, y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share &#39;Die Linke in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#39;Die Linke&#39; Vote Share and Net Migration in the 2013 and 2017 German Elections&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>)  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F)

gg_linke_eastwest_wanderung
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_linke_eastwest_wanderung, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div><h2 id="where-did-the-afd-come-from">Where did the AfD come from?</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_lagged_all <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(year <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, perc_afd) <span style="color:#f92672">%&gt;%</span> 
<span style="color:#a6e22e">left_join</span>(
  btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(year <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>) <span style="color:#f92672">%&gt;%</span>
  <span style="color:#a6e22e">select</span>(wahlkreis_nr, perc_spd, perc_cdu_csu, perc_linke, 
         perc_grun, perc_fdp, perc_npd))  <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(`AfD 2017` <span style="color:#f92672">=</span> perc_afd,
         `SPD 2013` <span style="color:#f92672">=</span> perc_spd,
         `CDU/CSU 2013` <span style="color:#f92672">=</span> perc_cdu_csu,
         `Die Linke 2013` <span style="color:#f92672">=</span> perc_linke,
         `Die Grünen 2013` <span style="color:#f92672">=</span> perc_grun,
         `FDP 2013` <span style="color:#f92672">=</span> perc_fdp,
         `NPD 2013` <span style="color:#f92672">=</span> perc_npd) <span style="color:#f92672">%&gt;%</span> 
<span style="color:#a6e22e">left_join</span>(
  btw_data <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">select</span>(wahlkreis_nr, east_west)) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>wahlkreis_nr) 

btw_lagged_all
</code></pre></div><pre><code>## # A tibble: 598 x 8
##    `AfD 2017` `SPD 2013` `CDU/CSU 2013` `Die Linke 2013` `Die Grünen 201~
##         &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1       6.84       32.6           38.2             5.66             9.79
##  2       6.84       32.6           38.2             5.66             9.79
##  3       6.54       29.7           43.4             4.41             8.11
##  4       6.54       29.7           43.4             4.41             8.11
##  5       8.54       30.0           41.9             5.03             7.59
##  6       8.54       30.0           41.9             5.03             7.59
##  7       7.41       31.5           40.8             4.36             9.26
##  8       7.41       31.5           40.8             4.36             9.26
##  9       6.91       34.7           30.3             6.91            14.1 
## 10       6.91       34.7           30.3             6.91            14.1 
## # ... with 588 more rows, and 3 more variables: `FDP 2013` &lt;dbl&gt;, `NPD
## #   2013` &lt;dbl&gt;, east_west &lt;chr&gt;
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">afd_origin <span style="color:#f92672">&lt;-</span> btw_lagged_all <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">gather</span>(parties, perc, <span style="color:#f92672">-</span>east_west, <span style="color:#f92672">-</span>`AfD 2017`) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(perc, `AfD 2017`, 
             color <span style="color:#f92672">=</span> east_west, 
             shape <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>(alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>parties, scales <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;free&#34;</span>) <span style="color:#f92672">+</span>
  ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_colorblind</span>(<span style="color:#e6db74">&#34;Region&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>()  <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2013 Vote Share in Percent&#34;</span>, 
       y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AfD Vote Share in 2017&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Where did AfD voters come from?&#34;</span>, 
       subtitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Comparing 2013 Election results with Vote Share of the AfD in the 2017 Election on the Electoral District Level&#34;</span>,
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from Federal Returning Officer (&#39;Bundeswahlleiter&#39;)\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
        legend.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bottom&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(shape <span style="color:#f92672">=</span> F) <span style="color:#75715e">#+</span>
  <span style="color:#75715e"># ggpubr::stat_cor()</span>

afd_origin
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(afd_origin, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>)
</code></pre></div><p><strong>To-Do</strong></p>
<h2 id="mapping">mapping</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_data <span style="color:#f92672">&lt;-</span> tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">load_it</span>(<span style="color:#e6db74">&#34;data/btw_data.Rdata&#34;</span>)

<span style="color:#a6e22e">library</span>(rgdal)
btw_raw <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">readOGR</span>(<span style="color:#e6db74">&#34;data/Geometrie_Wahlkreise_19DBT_geo.shp&#34;</span>) 
</code></pre></div><pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\Fabio\Documents\git_proj\btw_data\data\Geometrie_Wahlkreise_19DBT_geo.shp&quot;, layer: &quot;Geometrie_Wahlkreise_19DBT_geo&quot;
## with 299 features
## It has 4 fields
## Integer64 fields read as strings:  WKR_NR
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">plot</span>(btw_raw)
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_map_dat <span style="color:#f92672">&lt;-</span> btw_raw<span style="color:#f92672">@</span>data<span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">as.data.frame</span>() <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rownames_to_column</span>(<span style="color:#e6db74">&#34;id&#34;</span>)

btw_map_wt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">spTransform</span>(btw_raw, <span style="color:#a6e22e">CRS</span>(<span style="color:#e6db74">&#34;+proj=longlat +datum=WGS84&#34;</span>))

btw_map <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fortify</span>(btw_map_wt) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">left_join</span>(btw_map_dat, by <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;id&#34;</span>)


btw_map13 <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(year <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">inner_join</span>(btw_map <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(wahlkreis_nr <span style="color:#f92672">=</span> WKR_NR) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(wahlkreis_nr <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(wahlkreis_nr) <span style="color:#f92672">%&gt;%</span> as.integer))

btw_map17 <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(year <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">inner_join</span>(btw_map <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">rename</span>(wahlkreis_nr <span style="color:#f92672">=</span> WKR_NR) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(wahlkreis_nr <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(wahlkreis_nr) <span style="color:#f92672">%&gt;%</span> as.integer))


<span style="color:#75715e"># btw_map &lt;- bind_rows(btw_map13 %&gt;% </span>
<span style="color:#75715e">#             mutate(year = &#34;BTW 2013&#34;), </span>
<span style="color:#75715e">#           btw_map17 %&gt;% </span>
<span style="color:#75715e">#             mutate(year = &#34;BTW 2017&#34;))</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_map <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(btw_map13 <span style="color:#f92672">%&gt;%</span> 
            <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>), 
          btw_map17 <span style="color:#f92672">%&gt;%</span> 
            <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>))

gg_btw_map17 <span style="color:#f92672">&lt;-</span> btw_map17 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> perc_afd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_map</span>(map <span style="color:#f92672">=</span> btw_map17,
         <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> long, y <span style="color:#f92672">=</span> lat, group <span style="color:#f92672">=</span> group, map_id <span style="color:#f92672">=</span> id),
         color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>)  <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme_void</span>() <span style="color:#f92672">+</span>
  <span style="color:#75715e"># facet_wrap(~year) +</span>
  <span style="color:#a6e22e">coord_map</span>() <span style="color:#f92672">+</span>
  viridis<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_fill_viridis</span>(<span style="color:#e6db74">&#34;AfD Vote Share in %&#34;</span>,
                               option <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>, discrete <span style="color:#f92672">=</span> F, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">+</span>
                       <span style="color:#75715e">#       limits = c(1, 10),</span>
                       <span style="color:#75715e"># breaks = c(1:10),</span>
                       <span style="color:#75715e"># labels = c(1:10)) +</span>
  <span style="color:#a6e22e">theme</span>(plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
    legend.justification <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.82</span>, <span style="color:#ae81ff">0.91</span>),
    legend.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
    strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>),
    <span style="color:#75715e">#axis.ticks.length = unit(3, &#34;cm&#34;),</span>
    legend.direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;horizontal&#34;</span>,
    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>, title.hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                label.theme <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>))) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;German General Election 2017 - AfD Results&#34;</span>, 
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;299 Electoral Districts   \nData from Federal Returning Officer (&#39;Bundeswahlleiter&#39;)   \n@FabioFavusMaxim; favstats.eu   &#34;</span>)

gg_btw_map17
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_btw_map17, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_map <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(btw_map13 <span style="color:#f92672">%&gt;%</span> 
            <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>), 
          btw_map17 <span style="color:#f92672">%&gt;%</span> 
            <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>))

gg_btw_map <span style="color:#f92672">&lt;-</span> btw_map <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> perc_afd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_map</span>(map <span style="color:#f92672">=</span> btw_map17,
         <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> long, y <span style="color:#f92672">=</span> lat, group <span style="color:#f92672">=</span> group, map_id <span style="color:#f92672">=</span> id),
         color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>)  <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme_void</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">coord_map</span>() <span style="color:#f92672">+</span>
  viridis<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_fill_viridis</span>(<span style="color:#e6db74">&#34;AfD Vote Share in %&#34;</span>,
                               option <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>, discrete <span style="color:#f92672">=</span> F, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">+</span>
                       <span style="color:#75715e">#       limits = c(1, 10),</span>
                       <span style="color:#75715e"># breaks = c(1:10),</span>
                       <span style="color:#75715e"># labels = c(1:10)) +</span>
  <span style="color:#a6e22e">theme</span>(plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
    legend.justification <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">.63</span>, <span style="color:#ae81ff">0.91</span>),
    legend.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
    strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>),
    plot.margin<span style="color:#f92672">=</span><span style="color:#a6e22e">unit</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>),<span style="color:#e6db74">&#34;mm&#34;</span>),
    <span style="color:#75715e">#axis.ticks.length = unit(3, &#34;cm&#34;),</span>
    legend.direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;horizontal&#34;</span>,
    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>, title.hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                label.theme <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>))) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;German General Elections 2013 and 2017 - AfD Results\n&#34;</span>, 
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;299 Electoral Districts   \nData from Federal Returning Officer (&#39;Bundeswahlleiter&#39;)   \n@FabioFavusMaxim; favstats.eu   &#34;</span>)

gg_btw_map
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_btw_map, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">gg_btw_map_blue <span style="color:#f92672">&lt;-</span> btw_map <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> perc_afd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_map</span>(map <span style="color:#f92672">=</span> btw_map17,
         <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> long, y <span style="color:#f92672">=</span> lat, group <span style="color:#f92672">=</span> group, map_id <span style="color:#f92672">=</span> id),
         color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>)  <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme_void</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">coord_map</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">scale_fill_continuous</span>(<span style="color:#e6db74">&#34;AfD Vote Share in %&#34;</span>, 
                        low <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#00b4ff&#34;</span>, 
                        high <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;#002f42&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
    legend.justification <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">.63</span>, <span style="color:#ae81ff">0.91</span>),
    legend.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
    strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>),
    plot.margin<span style="color:#f92672">=</span><span style="color:#a6e22e">unit</span>(<span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>),<span style="color:#e6db74">&#34;mm&#34;</span>),
    <span style="color:#75715e">#axis.ticks.length = unit(3, &#34;cm&#34;),</span>
    legend.direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;horizontal&#34;</span>,
    plot.caption <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>, title.hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                label.theme <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">11</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>))) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;German General Elections 2013 and 2017 - AfD Results\n&#34;</span>, 
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;299 Electoral Districts   \nData from Federal Returning Officer (&#39;Bundeswahlleiter&#39;)   \n@FabioFavusMaxim; favstats.eu   &#34;</span>)

gg_btw_map_blue
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_btw_map_blue, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_map17_unemp <span style="color:#f92672">&lt;-</span> btw_map17 <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(fill <span style="color:#f92672">=</span> unemployment)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_map</span>(map <span style="color:#f92672">=</span> btw_map17,
         <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> long, y <span style="color:#f92672">=</span> lat, group <span style="color:#f92672">=</span> group, map_id <span style="color:#f92672">=</span> id),
         color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>)  <span style="color:#f92672">+</span> 
  <span style="color:#a6e22e">theme_void</span>() <span style="color:#f92672">+</span>
  <span style="color:#75715e"># facet_wrap(~year) +</span>
  <span style="color:#a6e22e">coord_map</span>() <span style="color:#f92672">+</span>
  viridis<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_fill_viridis</span>(<span style="color:#e6db74">&#34;Unemplyoment in %&#34;</span>,
                               option <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;D&#34;</span>, discrete <span style="color:#f92672">=</span> F, end <span style="color:#f92672">=</span> <span style="color:#ae81ff">.8</span>) <span style="color:#f92672">+</span>
                       <span style="color:#75715e">#       limits = c(1, 10),</span>
                       <span style="color:#75715e"># breaks = c(1:10),</span>
                       <span style="color:#75715e"># labels = c(1:10)) +</span>
  <span style="color:#a6e22e">theme</span>(plot.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>),
    legend.justification <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
    legend.position <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.3</span>, <span style="color:#ae81ff">0.82</span>),
    legend.title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(size <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>),
    <span style="color:#75715e">#axis.ticks.length = unit(3, &#34;cm&#34;),</span>
    legend.direction <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;horizontal&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">guides</span>(fill <span style="color:#f92672">=</span> <span style="color:#a6e22e">guide_colorbar</span>(barwidth <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, barheight <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                title.position <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;top&#34;</span>, title.hjust <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
                label.theme <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(colour <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;black&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, angle <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)))

btw_map17_unemp
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(btw_map17_unemp, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>)
</code></pre></div><h2 id="gganimate">gganimate</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># library(gganimate)</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># btw_data %&gt;% </span>
<span style="color:#75715e">#   ggplot(aes(unemployment, perc_afd, color = year)) +</span>
<span style="color:#75715e">#   geom_point() +</span>
<span style="color:#75715e">#   geom_smooth(method = &#34;lm&#34;) +</span>
<span style="color:#75715e">#   transition_states(year, transition_length = 10, state_length = 4)</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># btw_map_anim &lt;- btw_map %&gt;% </span>
<span style="color:#75715e">#   ggplot(aes(fill = perc_afd)) +</span>
<span style="color:#75715e">#   geom_map(map = btw_map,</span>
<span style="color:#75715e">#          aes(x = long, y = lat, group = group, map_id = id),</span>
<span style="color:#75715e">#          color = &#34;black&#34;, size = 0.4)  + </span>
<span style="color:#75715e">#   theme_void() +</span>
<span style="color:#75715e">#   coord_map() +</span>
<span style="color:#75715e">#   geom_text(aes(x = 7, y = 55, </span>
<span style="color:#75715e">#                 label = paste0(&#34;Year: &#34;, year)), size = 7) +</span>
<span style="color:#75715e">#   viridis::scale_fill_viridis(&#34;AfD Vote Share in %&#34;,</span>
<span style="color:#75715e">#                                option = &#34;D&#34;, discrete = F, end = .8) +</span>
<span style="color:#75715e">#                        #       limits = c(1, 10),</span>
<span style="color:#75715e">#                        # breaks = c(1:10),</span>
<span style="color:#75715e">#                        # labels = c(1:10)) +</span>
<span style="color:#75715e">#   theme(plot.title = element_text(hjust = 0.5, size = 19, face = &#34;bold&#34;),</span>
<span style="color:#75715e">#     legend.justification = c(1, 0),</span>
<span style="color:#75715e">#     legend.position = c(0.82, 0.91),</span>
<span style="color:#75715e">#     legend.title = element_text(size = 16, face = &#34;bold&#34;), </span>
<span style="color:#75715e">#     strip.text = element_text(size = 12),</span>
<span style="color:#75715e">#     #axis.ticks.length = unit(3, &#34;cm&#34;),</span>
<span style="color:#75715e">#     legend.direction = &#34;horizontal&#34;,</span>
<span style="color:#75715e">#     plot.caption = element_text(size = 13)) +</span>
<span style="color:#75715e">#   guides(fill = guide_colorbar(barwidth = 12, barheight = 0.5,</span>
<span style="color:#75715e">#                 title.position = &#34;top&#34;, title.hjust = 0.5,</span>
<span style="color:#75715e">#                 label.theme = element_text(colour = &#34;black&#34;, size = 14, angle = 0))) +</span>
<span style="color:#75715e">#   labs(title = &#34;German General Elections - AfD Results&#34;, </span>
<span style="color:#75715e">#        caption = &#34;299 Electoral Districts   \nData from Federal Returning Officer (&#39;Bundeswahlleiter&#39;)   \n@FabioFavusMaxim; favstats.eu   &#34;) +</span>
<span style="color:#75715e">#   transition_states(year, transition_length = 10, state_length = 4)</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># # btw_map_anim</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># # tidytemplate::ggsave_it(btw_map_anim, width = 8, height = 12)</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># btw_map_anim %&gt;% animate(</span>
<span style="color:#75715e">#   nframes = 100, fps = 15, width = 666.6667, height = 1000, detail = 1</span>
<span style="color:#75715e"># )</span>
<span style="color:#75715e"># </span>
<span style="color:#75715e"># anim_save(&#34;images/btw_map_anim.gif&#34;)</span>
</code></pre></div><h2 id="ggally">GGally</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">pacman<span style="color:#f92672">::</span><span style="color:#a6e22e">p_load</span>(GGally)

plot_lagged_all <span style="color:#f92672">&lt;-</span> btw_lagged_all <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggpairs</span>(lower <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>(continuous <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smooth&#34;</span>),
   mapping <span style="color:#f92672">=</span> <span style="color:#a6e22e">aes</span>(color <span style="color:#f92672">=</span> east_west)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Where did AfD voters come from?&#34;</span>, 
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))


<span style="color:#a6e22e">for</span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>plot_lagged_all<span style="color:#f92672">$</span>nrow) {
  <span style="color:#a6e22e">for</span>(j in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>plot_lagged_all<span style="color:#f92672">$</span>ncol){
    plot_lagged_all[i,j] <span style="color:#f92672">&lt;-</span> plot_lagged_all[i,j] <span style="color:#f92672">+</span> ggthemes<span style="color:#f92672">::</span><span style="color:#a6e22e">scale_color_fivethirtyeight</span>() 
  }
}

plot_lagged_all
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(plot_lagged_all, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>)
</code></pre></div><h2 id="sgb-ii">SGB II</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">btw_data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(btw17_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2017&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(part_of <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.character</span>(part_of)),
  btw13_data <span style="color:#f92672">%&gt;%</span> 
    <span style="color:#a6e22e">mutate</span>(year <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BTW 2013&#34;</span>)) 

mod13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> sgbii, data <span style="color:#f92672">=</span> btw13_data)
mod17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(perc_npd <span style="color:#f92672">~</span> sgbii, data <span style="color:#f92672">=</span> btw17_data)

<span style="color:#a6e22e">options</span>(scipen <span style="color:#f92672">=</span> <span style="color:#ae81ff">999</span>)

r2_13 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod13)
r2_17 <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">get_r2_label</span>(mod17)

label_dat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">tibble</span>(year <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;BTW 2013&#34;</span>, <span style="color:#e6db74">&#34;BTW 2017&#34;</span>),
     text <span style="color:#f92672">=</span>   <span style="color:#a6e22e">c</span>(
broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod13) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;sgbii&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_13)) <span style="color:#f92672">%&gt;%</span> 
  .$text,

broom<span style="color:#f92672">::</span><span style="color:#a6e22e">tidy</span>(mod17) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">filter</span>(term <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;sgbii&#34;</span>) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">mutate</span>(text <span style="color:#f92672">=</span> <span style="color:#a6e22e">paste0</span>(<span style="color:#e6db74">&#34;b = &#34;</span>, <span style="color:#a6e22e">round</span>(estimate, <span style="color:#ae81ff">2</span>), 
         <span style="color:#e6db74">&#34;, &#34;</span>, <span style="color:#a6e22e">get_labs</span>(p.value),
         <span style="color:#e6db74">&#34;, R Squared = &#34;</span>, r2_17)) <span style="color:#f92672">%&gt;%</span> 
  .$text
))

gg_npd_sgbii <span style="color:#f92672">&lt;-</span> btw_data <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(sgbii, perc_npd)) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_point</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_smooth</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lm&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>year) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme_minimal</span>() <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">geom_text</span>(data <span style="color:#f92672">=</span> label_dat, <span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, x <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, label <span style="color:#f92672">=</span> text), show.legend <span style="color:#f92672">=</span> F) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">labs</span>(x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sgbii Rate in %&#34;</span>, 
       y <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Vote Share npd in %&#34;</span>,
       title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;npd Vote Share and sgbii Rate in the 2013 and 2017 German Elections&#34;</span>, 
       caption <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;N = 299 Electoral Districts\nData from govdata.de and bundeswahlleiter.de\n@FabioFavusMaxim; favstats.eu&#34;</span>) <span style="color:#f92672">+</span>
  <span style="color:#a6e22e">theme</span>(title <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>), 
        strip.background <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_rect</span>(fill <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lightgrey&#34;</span>), 
        strip.text <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(face <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bold&#34;</span>))

gg_npd_sgbii
</code></pre></div><p><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">tidytemplate<span style="color:#f92672">::</span><span style="color:#a6e22e">ggsave_it</span>(gg_npd_sgbii, width <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, height <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>)
</code></pre></div>
      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/elections">elections</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/dataviz">dataviz</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/temperature_viz/">Visualizing Temperature Rise in Stuttgart, Germany over Time</a></li>
    
    <li><a href="/post/multicol_sim/">How does Collinearity Influence Linear Regressions?</a></li>
    
    <li><a href="/post/ecprconf18/">Analyzing Tweets of the ECPR General Conference 2018</a></li>
    
    <li><a href="/post/terror_map/">Mapping Terror Attacks with Highcharter</a></li>
    
    <li><a href="/post/tidylocations/">Mapping your 2017 Geolocations: The Tidy Way</a></li>
    
  </ul>
</div>




<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-favstats-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      © 2019 Fabio Votta &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//https-favstats-netlify-com.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

